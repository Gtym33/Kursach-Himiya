###########################
# Russian Civil War Events
###########################

add_namespace = rcw_catc


# Провозглашение туркестанской автономии, если октябрьская революция (исторический вариант)
country_event = {
	id = rcw_catc.1
	title = rcw_catc.1.t
	desc = rcw_catc.1.desc
	picture = GFX_report_event_sov_redarmy
	
	trigger = {
		has_start_date < 1918.7.2
		tag = RUS
		has_country_flag = RUS_Oktober_revolution_fired
	}
	
	mean_time_to_happen = {
		days = 20
	}
	
	fire_only_once = yes
	
	option = {
		name = rcw_catc.1.a
		every_state = {
			limit = {
				OWNER = { OR = { tag = ROOT tag = RUS is_subject_of = ROOT } }
				OR = {
					state = 405
					state = 589
					state = 885
					state = 586
					state = 732
					state = 1384
					state = 1018
					state = 1383
					state = 1295
					state = 1297
				}
			}
			TRK = { transfer_state = PREV }
		}
		TRK = {
			add_ideas = neutral_foreign_policy_law
			remove_all_foreing_locked_templates_from_liberated_country = yes
			country_event = { id = rcw_catc.2 days = 72 }
				hidden_effect = {
					every_country = {
						limit = {
							NOT = {
								tag = PREV
								is_any_former_russian_empire_country = yes
								former_russian_empire_baltic_states_country = yes tag = HRB
								has_war_with = PREV
								is_in_faction_with = PREV
							}
						}
						set_THIS_country_non_recognize_PREV = yes
					}
				}
		}
	}
	option = {
		name = rcw_catc.1.b
		trigger = {
			is_ai = no
		}
		every_state = {
			limit = {
				OWNER = { OR = { tag = ROOT tag = RUS is_subject_of = ROOT } }
				OR = {
					state = 405
					state = 589
					state = 885
					state = 586
					state = 732
					state = 1384
					state = 1018
					state = 1383
					state = 1295
					state = 1297
				}
			}
			TRK = { transfer_state = PREV }
		}
		TRK = {
			add_ideas = neutral_foreign_policy_law
			remove_all_foreing_locked_templates_from_liberated_country = yes
			country_event = { id = rcw_catc.2 days = 72 }
				hidden_effect = {
					every_country = {
						limit = {
							NOT = {
								tag = PREV
								is_any_former_russian_empire_country = yes
								former_russian_empire_baltic_states_country = yes tag = HRB
								has_war_with = PREV
								is_in_faction_with = PREV
							}
						}
						set_THIS_country_non_recognize_PREV = yes
					}
				}
		}
		TRK = { change_tag_from = RUS }
	}
}

# Восстание в Ташкенте большевиков (исторический вариант, временно заскриптован)
country_event = {
	id = rcw_catc.2
	title = rcw_catc.2.t
	desc = rcw_catc.2.desc
	picture = GFX_report_event_sib_long_live_the_dmitry
	
	is_triggered_only = yes
	
	fire_only_once = yes
	
	option = {
		name = rcw_catc.2.a
		create_field_marshal = {  name = "Ivan Belov"  portrait_path = "gfx/leaders/SOV/Portrait_Ivan_Belov.dds" traits = { thorough_planner } skill = 2 }
		create_corps_commander = {  name = "Alibi Dzhangildin"  portrait_path = "gfx/leaders/SOV/Portrait_Alibi_Dzhangildin.dds" traits = { thorough_planner } skill = 2 }
		set_politics = { ruling_party = communism }
		RUS = { TRK = { subjecting_script_with_transfer_parties_semi_independent = yes } }
		add_ideas = limited_conscription
		add_ideas = workers_control_law
		add_ideas = good_legislation
		add_ideas = war_economy
		
		every_state = {
			limit = {
				OWNER = { OR = { tag = ROOT tag = RUS is_subject_of = ROOT } }
				is_core_of = TRK
			}
			TRK = { transfer_state = PREV }
		}
		TRK = {
			transfer_state = 1381
			transfer_state = 1305
			transfer_state = 1306
			transfer_state = 1310
		}
		BUK = {
			diplomatic_relation = {
				country = TRK
				relation = military_access
				active = yes
			}
		}
		
		load_oob = TRK_rise_left
	}
}

# Рейхскомиссариат Туркестан ("Судьба Туркестана")
country_event = {
	id = rcw_catc.100
	title = rcw_catc.100.t
	desc = rcw_catc.100.desc
	picture = GFX_report_event_kharkov
	
	trigger = {
		NOT = { has_global_flag = RUS_civil_war_over }
		has_global_flag = RUS_civil_war_intervention_start
		is_former_russian_empire_russian_country = yes
		NOT = { original_tag = RUS }
		TRK = { OR = { exists = no AND = { has_capitulated = yes has_war_with = ROOT } } }
		is_subject = no
		405 = {
			CONTROLLER = {
				OR = {
					tag = ROOT
					is_subject_of = ROOT
				}
			}
		}
		NOT = {
			any_state = {
				is_core_of = TRK
				NOT = { is_core_of = RUS }
				NOT = { is_core_of = CPG }
				NOT = { is_core_of = KHI }
				NOT = { is_core_of = ROOT }
				impassable = yes
				CONTROLLER = { has_war_with = ROOT NOT = { tag = TRK } }
			}
		}
	}
	
	fire_only_once = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = rcw_catc.100.a
		ai_chance = {
			factor = 0
		}
	}
	option = {
		trigger = {
			KAZ = { is_subject_of = ROOT }
		}
		name = rcw_catc.100.b
		every_state = {
			limit = {
				is_core_of = TRK
				NOT = { is_core_of = RUS }
				NOT = { is_core_of = CPG }
				NOT = { is_core_of = KHI }
				NOT = { is_core_of = ROOT }
				CONTROLLER = { NOT = { has_war_with = ROOT tag = TRK } }
			}
			if = {
				limit = { OWNER = { OR = { tag = ROOT is_subject_of = ROOT } } }
				KAZ = { set_state_owner = PREV }
			}
			KAZ = { set_state_controller = PREV }
		}
	}
	option = {
		name = rcw_catc.100.c
		add_political_power = -25
		hidden_effect = {
			TRK = {
				OVERLORD = { end_puppet = PREV }
				leave_faction = yes
			}
			if = {
				limit = { OR = { is_in_faction = no is_faction_leader = yes } }
				white_peace = TRK
				else = {
					random_other_country = {
						limit = { is_in_faction_with = ROOT is_faction_leader = yes }
						white_peace = TRK
					}
				}
			}
		}
		every_state = {
			limit = {
				is_core_of = TRK
				NOT = { is_core_of = RUS }
				NOT = { is_core_of = CPG }
				NOT = { is_core_of = KHI }
				NOT = { is_core_of = ROOT }
				CONTROLLER = { NOT = { has_war_with = ROOT tag = TRK } }
			}
			TRK = { transfer_state = PREV }
		}
		puppet = TRK
		set_autonomy = {
			target = TRK
			autonomy_state = autonomy_semi_independent
		}
	}
	option = {
		name = rcw_catc.100.d
		add_political_power = -50
		hidden_effect = {
			TRK = {
				OVERLORD = { end_puppet = PREV }
				leave_faction = yes
			}
			if = {
				limit = { OR = { is_in_faction = no is_faction_leader = yes } }
				white_peace = TRK
				else = {
					random_other_country = {
						limit = { is_in_faction_with = ROOT is_faction_leader = yes }
						white_peace = TRK
					}
				}
			}
		}
		every_state = {
			limit = {
				is_core_of = TRK
				NOT = { is_core_of = RUS }
				NOT = { is_core_of = CPG }
				NOT = { is_core_of = KHI }
				NOT = { is_core_of = ROOT }
				CONTROLLER = { NOT = { has_war_with = ROOT tag = TRK } }
			}
			TRK = { transfer_state = PREV }
		}
		puppet = TRK
		set_autonomy = {
			target = TRK
			autonomy_state = autonomy_integrated_puppet
		}
	}
}


# Восстание в Ашбахаде
country_event = {
	id = rcw_catc.101
	title = rcw_catc.101.t
	desc = rcw_catc.101.desc
	picture = GFX_report_event_kharkov
	
	trigger = {
		has_start_date < 1918.7.2
		tag = RUS
		OR = {
			has_government = communism
			has_government = radical_socialism
		}
		has_country_flag = RUS_Oktober_revolution_fired
		has_country_flag = RUS_czechoslovak_legion_uprising
	}

	mean_time_to_happen = {
		days = 20
	}
	
	fire_only_once = yes
	
	option = {
		name = rcw_catc.101.a
		if = {
			limit = { has_country_flag = Alexandr_Kolchak_in_Mesopotamia }
			ENG = { clr_country_flag = Alexandr_Kolchak_in_Mesopotamia }
			country_event = { id = rcw_kolchak.6 hours = 2 }
		}
		if = {
			limit = { TRK = { is_subject_of = RUS } }
			TKR = { load_oob = RUS_Merv_red_guard }
			else = { RUS = { load_oob = RUS_Merv_red_guard } }
		}
		every_state = {
			limit = {
				OR = {
					state = 584
					state = 1388
					state = 1387
					state = 1386
					state = 1089
					state = 1280
					state = 1091
				}
				is_core_of = RUS
			}
			add_core_of = CPG
		}
		every_state = {
			limit = {
				OR = {
					state = 584
					state = 1388
					state = 1387
				}
			}
			CPG = { transfer_state = PREV }
		}
		CPG = {
			inherit_technology = RUS
			hidden_effect = { ENG = { country_event = { id = rcw_catc.102 days = 10 } } }
			add_ideas = neutral_foreign_policy_law
			add_ideas = CPG_revolutionary_fever 
			add_ideas = CPG_lack_of_resources
			add_ideas = CPG_poor_infrastructure
			add_ideas = CPG_weakness_of_central_government
			load_focus_tree = Caspiy_focus
			remove_all_foreing_locked_templates_from_liberated_country = yes
			declare_war_on = {
				target = RUS
				type = annex_everything
			}
			load_oob = CPG_rise
				hidden_effect = {
					every_country = {
						limit = {
							NOT = {
								tag = PREV
								is_any_former_russian_empire_country = yes
								former_russian_empire_baltic_states_country = yes tag = HRB
								has_war_with = PREV
								is_in_faction_with = PREV
							}
						}
						set_THIS_country_non_recognize_PREV = yes
					}
				}
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		trigger = { is_ai = no }
		name = rcw_catc.101.b
		if = {
			limit = { has_country_flag = Alexandr_Kolchak_in_Mesopotamia }
			ENG = { clr_country_flag = Alexandr_Kolchak_in_Mesopotamia }
			country_event = { id = rcw_kolchak.6 hours = 2 }
		}
		if = {
			limit = { TRK = { is_subject_of = RUS } }
			TKR = { load_oob = RUS_Merv_red_guard }
			else = { RUS = { load_oob = RUS_Merv_red_guard } }
		}
		every_state = {
			limit = {
				OR = {
					state = 584
					state = 1388
					state = 1387
					state = 1386
					state = 1089
					state = 1280
					state = 1091
				}
				is_core_of = RUS
			}
			add_core_of = CPG
		}
		every_state = {
			limit = {
				OR = {
					state = 584
					state = 1388
					state = 1387
				}
			}
			CPG = { transfer_state = PREV }
		}
		CPG = {
			inherit_technology = RUS
			hidden_effect = { ENG = { country_event = { id = rcw_catc.102 days = 10 } } }
			add_ideas = neutral_foreign_policy_law
			remove_all_foreing_locked_templates_from_liberated_country = yes
			declare_war_on = {
				target = RUS
				type = annex_everything
			}
			load_oob = CPG_rise
				hidden_effect = {
					every_country = {
						limit = {
							NOT = {
								tag = PREV
								is_any_former_russian_empire_country = yes
								former_russian_empire_baltic_states_country = yes tag = HRB
								has_war_with = PREV
								is_in_faction_with = PREV
							}
						}
						set_THIS_country_non_recognize_PREV = yes
					}
				}
		}
		CPG = { change_tag_from = RUS }
		ai_chance = {
			factor = 0
		}
	}
}

# Английская интервенция
country_event = {
	id = rcw_catc.102
	title = rcw_catc.102.t
	desc = rcw_catc.102.d
	picture = GFX_report_event_kharkov
	
	trigger = {
		tag = ENG
		RUS = {
			OR = {
				has_government = communism
				has_government = radical_socialism
			}
			has_country_flag = RUS_Oktober_revolution_fired
			has_country_flag = RUS_czechoslovak_legion_uprising
		}
	}
	is_triggered_only = yes
	
	fire_only_once = yes
	
	option = {
		name = rcw_catc.102.a
		CPG = {
			load_oob = CPG_eng
			create_country_leader = { name = "Wilfrid Malleson" desc = "" picture = "gfx/leaders/ENG/Portrait_Wilfrid_Malleson.dds" expire = "1947.1.1" ideology = despotism_ideology traits = { warmonger_old_general } }
			every_unit_leader = { limit = { has_id = 88160 } set_nationality = CPG }
			set_country_flag = CPG_eng
			hidden_effect = { country_event = { id = rcw_catc.103 days = 250 } }
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = rcw_catc.102.b
		ai_chance = {
			factor = 0
		}
	}
}

# Закаспий под ВБ
country_event = {
	id = rcw_catc.103
	title = rcw_catc.103.t
	desc = rcw_catc.103.d
	picture = GFX_report_event_kharkov
	
	is_triggered_only = yes
	
	fire_only_once = yes
	
	option = {
		name = rcw_catc.103.a
		ai_chance = {
			factor = 999
		}
		set_politics = { ruling_party = despotism elections_allowed = no }
	}
	#option = {
		#name = rcw_catc.103.b
	#}
}
#Успешное асхабадское Восстание
country_event = {
	id = rcw_catc.104
	title = rcw_catc.104.t
	desc = rcw_catc.104.d
	picture = GFX_report_event_kharkov
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = rcw_catc.104.a
		ai_chance = {
			factor = 999
		}
		add_stability = 0.05
		add_manpower = 300
	}
}
# Поиск покровительства 
 country_event = {
	id = rcw_catc.105
	title = rcw_catc.105.t
	desc = rcw_catc.105.d
	picture = GFX_report_event_kharkov
	
	is_triggered_only = yes
	
	fire_only_once = yes

	option = {
		name = rcw_catc.105.a
		    trigger = {
			    country_exists = RVA
		    }
		    RVA = {
			    country_event =  rcw_catc.106
		    }
	    }
		option = {
			name = rcw_catc.105.b
			trigger = {
				OR = {
				country_exists = SIB
				country_exists = RSS
				}
			}
			SIB = {
				country_event =  rcw_catc.107
			}
			RSS = {
				country_event =  rcw_catc.107
			}
		}
		option = {
			name = rcw_catc.105.c
			trigger = {
				NOT = {
					country_exists = SIB
					country_exists = RVA
				}
			}
		}
		option = {
			name = rcw_catc.105.f
	            trigger = {
		            has_completed_focus = CPG_zapros_new_kontiogentov
		            has_completed_focus = CPG_econom_sotr_eng
		            has_completed_focus = CPG_sovm_operations
		            custom_trigger_tooltip = {
                        tooltip = 1
                        check_variable = { CPG_skochko > 0.79 }
					}
	            }
				ENG = { country_event = rcw_catc.117 }
			}
		}
		#оповещение доброармии
country_event = {
 			id = rcw_catc.106
			title = rcw_catc.106.t
			desc = rcw_catc.106.d
			is_triggered_only = yes
			fire_only_once = yes
			option = {
				name = rcw_catc.106.a
				CPG = {
					set_country_flag = succses_trip
					complete_national_focus = CPG_dogovor_s_RVA
				}
			}
		}
		# оповещение сибири
country_event = {
 			id = rcw_catc.107
			title = rcw_catc.107.t
			desc = rcw_catc.107.d
			is_triggered_only = yes
			fire_only_once = yes
			option = {
				name = rcw_catc.107.a
				CPG = {
					set_country_flag = cpg_succses_treaty
					complete_national_focus = CPG_podchinenie_SIB
				}
			}
		}
		# Назначение генерала савицкого
		country_event = {
			id = rcw_catc.108
			title = rcw_catc.108.t
			desc = rcw_catc.108.d
			is_triggered_only = yes
			fire_only_once = yes
			option = {
				name = rcw_catc.108.a
				add_ideas = hippolyte_savitskiy_2
			}
		}
		# Организация комиссаров
		country_event = {
			id = rcw_catc.109
			title = rcw_catc.109.t
			desc = rcw_catc.109.d
			is_triggered_only = yes
			fire_only_once = yes
			option = {
				name = rcw_catc.109.a
			}
		}
	country_event = {
		id = rcw_catc.110
		title = rcw_catc.110.t
		desc = rcw_catc.110.d
		is_triggered_only = yes
		fire_only_once = yes
		option = {
			name = rcw_catc.110.a
			remove_ideas = v_dohov
			add_ideas = y_makarov
			add_ideas = i_druzhkin
			add_ideas = smirnov
		}

	}
	# переговоры с британцами
	country_event = {
		id = rcw_catc.111
		title = rcw_catc.111.t
		desc = rcw_catc.111.d 
		is_triggered_only = yes
		fire_only_once = yes
		option = {
			name = rcw_catc.111.a
			ENG = {
				country_event = {
					id = rcw_catc.112
					days = 7
				}
			}
		}
	}
	# английские раздумья
	country_event = {
		id = rcw_catc.112
		title = rcw_catc.112.t
		desc = rcw_catc.112.d
		is_triggered_only = yes 
		fire_only_once = yes
		option = {
			name = rcw_catc.112.a
			CPG = {
				country_event = rcw_catc.113
			}
		}
	}
	#итог
	country_event = {
		id = rcw_catc.113
		title = rcw_catc.113.t
		desc = rcw_catc.113.d
		is_triggered_only = yes 
		fire_only_once = yes
		option = {
			name = rcw_catc.113.a
			set_country_flag = cpg_accses_to_british
			custom_effect_tooltip = CPG_pomosh_yes
		}
		option = {
			name = rcw_catc.113.b
			custom_effect_tooltip = CPG_effect_minus
			custom_effect_tooltip = CPG_pomosh_no
			SPG_set_buz_faction_values = yes
			CPG_reshenie_2_effect = yes
		}
	}
	#союз с бухарой
	country_event = {
		id = rcw_catc.114
		title = rcw_catc.114.t
		desc = rcw_catc.114.d
		is_triggered_only = yes 
		fire_only_once = yes
		option = {
			name = rcw_catc.114.a
			CPG = {
				country_event = rcw_catc.115
			}
			ai_chance = {
			factor = 30
		}
		}
		
		option = {
			name = rcw_catc.114.b
			ai_chance = {
				factor = 70
				}
			}
		}
		country_event = {
			id = rcw_catc.115
			title = rcw_catc.115.t
			desc = rcw_catc.115.d
			is_triggered_only = yes
			fire_only_once = yes
			option = {
				name = rcw_catc.115.a
				create_faction = TRK_UNION 
				CPG = { add_to_faction = BUK }

			}
		}
		country_event = {
			id = rcw_catc.116
			title = rcw_catc.116.t
			desc = rcw_catc.116.d
			picture = GFX_report_event_cpg_yseturk_syezd
			
			is_triggered_only = yes
			
			option = {
				name = rcw_catc.116.a
				custom_effect_tooltip = CPG_form_vseturk_tt
			    hidden_effect = {
			        every_controlled_state = { 
                        create_unit = {
					        division = "name = \"Ashabadskiy polk\" division_template = \"Zakaspiyskaya brigada opolcheniya\" start_experience_factor = 0.0 start_equipment_factor = 1"
					        owner = CPG
					        count = 1
				        }
                    }
			    }

			}
		}
		country_event = {
			id = rcw_catc.117
			title = rcw_catc.117.t
			desc = rcw_catc.117.d
			picture = GFX_report_event_cpg_yseturk_syezd
			
			is_triggered_only = yes
			
			option = {
				name = rcw_catc.117.a
                CPG = { country_event = rcw_catc.118 }
			}
			option = {
				name = rcw_catc.117.b
                CPG = { country_event = rcw_catc.119 }
			}
		}
		country_event = {
			id = rcw_catc.118
			title = rcw_catc.118.t
			desc = rcw_catc.118.d
			picture = GFX_report_event_generic_sign_treaty2
			
			is_triggered_only = yes
			
			option = {
				name = rcw_catc.118.a
				load_focus_tree = Transcaspian_government_britanian_focus
                every_country = {
			        ENG = { every_unit_leader = { limit = { OR = { has_id = 88160 } } set_nationality = CPG } }
		        }
		        create_country_leader = {
			        name = "Wilfrid Malleson"
			        desc = "CPG_Wilfrid Malleson_DESC"
			        picture = GFX_Portrait_Wilfrid_Malleson
			        expire = "1965.1.1"
			        ideology = despotism_ideology
			        traits = {
					    warmonger_old_general
			        }
		        }
		        set_politics = {
			        ruling_party = despotism
			        elections_allowed = no
			        last_election = "1922.12.17"
			        election_frequency = 48
		        }
		        add_popularity = {
			        ideology = despotism
			        popularity = 0.15
		        }
		        set_party_name = {
			        ideology = despotism
			        long_name = CPG_eng_party_long
			        name = CPG_eng_party
		        }
				remove_ideas = CPG_army_poor_army
				remove_ideas = CPG_army_poor_army_1
				remove_ideas = CPG_weakness_of_central_government
				remove_ideas = help_from_foreign_interventionists
				remove_ideas = CPG_jmo_with_british
				set_country_flag = CPG_eng_yes_poddanstvo
				hidden_effect = {
				    country_event = { id = rcw_catc.120 days = 6 }
				}
			}
		}
		country_event = {
			id = rcw_catc.119
			title = rcw_catc.119.t
			desc = rcw_catc.119.d
			picture = GFX_report_event_generic_sign_treaty2
			
			is_triggered_only = yes
			
			option = {
				name = rcw_catc.119.a
                set_country_flag = CPG_eng_otkaz_poddanstvo
			}
		}
		country_event = {
			id = rcw_catc.120
			title = rcw_catc.120.t
			desc = rcw_catc.120.d
			picture = GFX_report_event_cpg_officer_bunt
			
			is_triggered_only = yes
			
			option = {
				name = rcw_catc.120.a
                set_country_flag = CPG_narod_bunt
                add_ideas = CPG_narod_bunt_idea_2
			}
		}
		country_event = {
			id = rcw_catc.121
			title = rcw_catc.121.t
			desc = rcw_catc.121.d
			picture = GFX_report_event_generic_train
			
			is_triggered_only = yes
			
			option = {
				name = rcw_catc.121.a
                add_ideas = corporatocracy_law
				add_ideas = CPG_vivox_resyrs_1
				ENG = { add_ideas = CPG_eng_vivox_resyrs_1 }
				give_resource_rights = { receiver = ENG state = 1388 }
				add_offsite_building = { type = industrial_complex level = 1 }
			}
			option = {
				name = rcw_catc.121.b
                add_ideas = corporatocracy_law
				add_ideas = CPG_vivox_resyrs_2
				ENG = {
				    add_ideas = CPG_eng_vivox_resyrs_2 
                    add_opinion_modifier = {
                        target = CPG
                        modifier = BLR_Ylychenie_otnocheniy
					}
				}
				give_resource_rights = { receiver = ENG state = 1388 }
				give_resource_rights = { receiver = ENG state = 584 }
				add_offsite_building = { type = industrial_complex level = 3 }
			}
		}