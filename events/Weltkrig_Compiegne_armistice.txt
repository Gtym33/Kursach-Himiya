###########################
# Armistice of Compiègne Events (Capitulations)
###########################

add_namespace = compiegne_armistice

# Уничтожение армии
country_event = {
	id = compiegne_armistice.-1
	hidden = yes
	is_triggered_only = yes
	option = {
		hidden_effect = {
			delete_unit = {
				disband = yes
			}
			remove_all_Brigada_Chekhoslovatskogo_legiona = yes
			remove_all_foreing_locked_templates_from_liberated_country = yes
			random_owned_controlled_state = {
				REB = { transfer_state = PREV }
			}
			transfer_units_fraction = {
				target = REB
				size = 1
				stockpile_ratio = 1
				army_ratio = 1
				navy_ratio = 1
				air_ratio = 1
				keep_unit_leaders_trigger = { always = yes }
			}
			annex_country = {
				target = REB
				transfer_troops = yes
			}
		}
	}
}
# Очередной костыль заключения мира
country_event = {
	id = compiegne_armistice.0
	hidden = yes
	is_triggered_only = yes
	option = {
		if = {
			limit = { is_subject = yes }
			OVERLORD = { end_puppet = ROOT }
		}
		leave_faction = yes
	}
}

###### Капитуляция Центральных держав ######

# Османия (Турция)
country_event = {
	id = compiegne_armistice.1
	title = compiegne_armistice.1.t
	desc = compiegne_armistice.1.d
	picture = GFX_report_event_ott_peace_ww1
	
	fire_only_once = yes
	
	trigger = {
		tag = TUR
		has_global_flag = WWI_is_now
		NOT = { has_global_flag = WWI_TUR_HAS_CAPITULATED }
		OR = {
			has_war_with = ENG
			has_war_with = FRA
		}
		OR = {
			AND = {
				OR = {
					has_global_flag = WWI_AUH_HAS_CAPITULATED
					has_global_flag = WWI_GER_HAS_CAPITULATED
				}
				surrender_progress > 0.1
			}
			AND = {
				has_stability < 0.75
				surrender_progress > 0.45
			}
			AND = {
				has_stability < 0.7
				surrender_progress > 0.4
			}
			AND = {
				has_stability < 0.65
				surrender_progress > 0.35
			}
			AND = {
				has_stability < 0.6
				surrender_progress > 0.3
			}
			AND = {
				has_stability < 0.55
				surrender_progress > 0.25
			}
			AND = {
				has_stability < 0.5
				surrender_progress > 0.2
			}
			AND = {
				has_stability < 0.45
				surrender_progress > 0.15
			}
			surrender_progress > 0.5
			has_stability < 0.3
			AND = {
				has_stability < 0.35
				NOT = { controls_state = 554 }
				NOT = { controls_state = 677 }
			}
			AND = {
				has_stability < 0.35
				NOT = { controls_state = 554 }
				NOT = { controls_state = 291 }
			}
			AND = {
				has_stability < 0.4
				NOT = { controls_state = 554 }
				NOT = { controls_state = 291 }
				NOT = { controls_state = 677 }
			}
			has_capitulated = yes
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		every_country = {
			limit = { OR = { is_subject = no tag = AST tag = SAF tag = CAN tag = NZL } NOT = { has_country_flag = WWI_Entente_member } has_war_with = TUR OR = { is_in_faction_with = ENG is_in_faction_with = FRA } NOT = { is_in_faction_with = GER } NOT = { tag = BUL tag = TUR tag = GER tag = AUH } }
			set_country_flag = WWI_Entente_member
		}
		every_country = {
			limit = { has_country_flag = WWI_Entente_member OR = { NOT = { is_in_faction_with = ENG is_in_faction_with = FRA } is_in_faction_with = GER is_in_faction_with = AUH } }
			clr_country_flag = WWI_Entente_member
		}
		every_country = {
			limit = { NOT = { has_country_flag = WWI_Central_Powers_member } has_war_with = ENG OR = { is_in_faction_with = GER is_in_faction_with = AUH is_in_faction_with = BUL is_in_faction_with = TUR } NOT = { tag = ENG tag = FRA tag = ITA tag = RUS } }
			set_country_flag = WWI_Central_Powers_member
		}
		every_country = {
			limit = { has_country_flag = WWI_Central_Powers_member OR = { is_in_faction_with = ENG has_war_with = GER has_war_with = AUH NOT = { has_war_with = ENG } } }
			clr_country_flag = WWI_Central_Powers_member
		}
		if = {
			limit = { RUS = { has_country_flag = WWI_Entente_member has_country_flag = RUS_monarchy_not_fall has_variable = RUS_otrecheniye } }
			RUS = { add_to_variable = { RUS_otrecheniye = -1 } }
		}
	}
	option = {
		name = compiegne_armistice.1.a
		set_global_flag = WWI_TUR_HAS_CAPITULATED
		every_unit_leader = {
			limit = { OR = { has_id = 90001 has_id = 90004 } }
			set_nationality = REB
		}
		hidden_effect = {
			every_state = {
				limit = {
					OR = {
						region = 130
						region = 239
						region = 240
						region = 133
						region = 131
						state = 93
					}
					is_core_of = UKR
					is_owned_by = AUH
				}
				UKR = { transfer_state = PREV }
			}
			every_state = {
				limit = {
					OR = {
						region = 130
						region = 239
						region = 240
						region = 133
						region = 131
						state = 93
					}
					is_core_of = USR
					is_owned_by = AUH
				}
				USR = { transfer_state = PREV }
			}
			if = {
				limit = { owns_state = 240 }
				221 = { OWNER = { transfer_state = 240 } }
			}
			if = {
				limit = { country_exists = CRI }
				every_state = {
					limit = {
						is_owned_by = ROOT
						region = 230
						NOT = { is_core_of = ROOT }
					}
					CRI = { transfer_state = PREV }
				}
				else = {
					random_other_country = {
						limit = { any_owned_state = { region = 230 } }
						every_state = {
							limit = {
								is_owned_by = ROOT
								region = 230
								NOT = { is_core_of = ROOT }
							}
							PREV = { transfer_state = PREV }
						}
					}
				}
			}
		}
		every_state = {
			limit = {
				OR = {
					region = 133
					region = 135
					region = 137
				}
				is_core_of = RUS
				is_owned_by = AUH
			}
			RUS = { transfer_state = PREV }
		}
		if = {
			limit = { TUR = { NOT = { has_war_with = RUS OR = { 230 = { OWNER = { OR = { tag = RUS tag = TUR is_subject_of = TUR } } } 899 = { OWNER = { OR = { tag = RUS tag = TUR is_subject_of = TUR } } } } } } }
			every_state = {
				limit = {
					region = 134
					is_core_of = TUR
				}
				add_core_of = KRS
				KRS = { transfer_state = PREV }
			}
		}
		TUR = {
			every_state = {
				limit = { is_core_of = KRS is_owned_by = TUR }
				KRS = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = AZR is_owned_by = TUR }
				AZR = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = GEO is_owned_by = TUR }
				GEO = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = ARM is_owned_by = TUR }
				ARM = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = YEM is_owned_by = TUR }
				YEM = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = SAU is_owned_by = TUR }
				SAU = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = ASU is_owned_by = TUR }
				ASU = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = ASR is_owned_by = TUR }
				ASR = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = HJZ is_owned_by = TUR }
				HJZ = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = BUK is_owned_by = TUR }
				BUK = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = KHI is_owned_by = TUR }
				KHI = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = TRK is_owned_by = TUR }
				TRK = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = SIB is_owned_by = TUR }
				SIB = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = KAZ is_owned_by = TUR }
				KAZ = { transfer_state = PREV }
			}
			if = {
				limit = {
					any_country = {
						NOT = { tag = TUR }
						is_socialist_country = yes
						count_triggers = { amount = 3 controls_state = 341 controls_state = 343 controls_state = 346 controls_state = 49 controls_state = 347 controls_state = 348 controls_state = 356 controls_state = 349 controls_state = 355 }
					}
				}
				set_country_flag = communist_occ
			}
			if = {
				limit = { has_war_with = BUL NOT = { has_global_flag = WWI_BUL_HAS_CAPITULATED } }
				every_state = {
					limit = { is_owned_by = TUR OR = { region = 25 region = 26 } }
					BUL = { transfer_state = PREV }
				}
			}
			if = {
				limit = { has_war_with = RUS OR = { 230 = { OWNER = { OR = { tag = RUS tag = TUR is_subject_of = TUR } } } 899 = { OWNER = { OR = { tag = RUS tag = TUR is_subject_of = TUR } } } } }
				every_state = {
					limit = { is_owned_by = TUR OR = { region = 134 state = 353 state = 1304 state = 354 state = 800 is_claimed_by = RUS is_core_of = RUS } }
					RUS = { transfer_state = PREV }
				}
			}
			if = {
				limit = { has_war_with = FRA }
				every_state = {
					limit = { is_owned_by = TUR OR = { is_core_of = SYR is_core_of = LEB state = 344 state = 350 is_claimed_by = FRA is_core_of = FRA } }
					FRA = { transfer_state = PREV }
				}
			}
			if = {
				limit = { has_war_with = ENG }
				every_state = {
					limit = { is_owned_by = TUR OR = { region = 28 region = 116 state = 344 state = 350 state = 352 is_claimed_by = ENG is_core_of = ENG } }
					ENG = { transfer_state = PREV }
				}
			}
			if = {
				limit = { has_war_with = ITA }
				every_state = {
					limit = { is_owned_by = TUR OR = { state = 164 state = 342 is_claimed_by = ITA is_core_of = ITA } }
					ITA = { transfer_state = PREV }
				}
			}
			if = {
				limit = { has_war_with = GRE GRE = { OR = { controls_state = 339 controls_state = 340 } } }
				every_state = {
					limit = { is_owned_by = TUR OR = { state = 339 is_claimed_by = GRE is_core_of = GRE } }
					GRE = { transfer_state = PREV }
				}
			}
			else_if = {
				limit = { has_war_with = GRR GRR = { OR = { controls_state = 339 controls_state = 340 } } }
				every_state = {
					limit = { is_owned_by = TUR OR = { state = 339 is_claimed_by = GRR is_core_of = GRR } }
					GRR = { transfer_state = PREV }
				}
			}
			if = {
				limit = { has_war_with = RUS RUS = { OR = { controls_state = 341 controls_state = 797 controls_state = 949 } } }
				every_state = {
					limit = { is_owned_by = TUR OR = { state = 1403 state = 1402 state = 1405 state = 949 state = 797  } }
					RUS = { transfer_state = PREV }
				}
			}
			else_if = {
				limit = { has_war_with = FRA FRA = { OR = { controls_state = 341 controls_state = 797 controls_state = 949 } } }
				every_state = {
					limit = { is_owned_by = TUR OR = { state = 1403 state = 1402 state = 1405 state = 949 } }
					FRA = { transfer_state = PREV }
				}
			}
			else_if = {
				limit = { has_war_with = ITA ITA = { OR = { controls_state = 341 controls_state = 797 controls_state = 949 } } }
				every_state = {
					limit = { is_owned_by = TUR OR = { state = 1403 state = 1402 state = 1405 state = 949 } }
					ITA = { transfer_state = PREV }
				}
			}
			else_if = {
				limit = { has_war_with = ENG }
				every_state = {
					limit = { is_owned_by = TUR OR = { state = 1403 state = 1402 state = 1405 state = 949 } }
					ENG = { transfer_state = PREV }
				}
			}
			leave_faction = yes
			add_ideas = {
				limited_monarchy_gov_form
				decrees_of_ruler_b_law
				poliparty_system_law
				neutral_foreign_policy_law
				civilian_economy
				disarmed_nation
				#TUR_permanent_political_crisis
			}
			clr_country_flag = TUR_triumvirate_enver_cemal_talaat
			clr_country_flag = TUR_duumvirate_enver_cemal
			clr_country_flag = TUR_duumvirate_cemal_talaat
			clr_country_flag = TUR_duumvirate_enver_talaat
			clr_country_flag = TUR_cemal_is_egyptian_owner
			clr_country_flag = TUR_cemal_is_syrian_owner
			clr_country_flag = TUR_cemal_is_syrian_owner
			clr_country_flag = TUR_young_turk_secular
			clr_country_flag = TUR_pan_islamic_propaganda_enable
			clr_country_flag = TUR_pan_turanist_propaganda_enable
			retire_ideology_leader = despotism
			add_popularity = { ideology = despotism popularity = -0.3 }
			country_event = turkey.0
			set_politics = {
				ruling_party = authoritarism
				elections_allowed = no
			}
			remove_ideas = {
				TUR_Mehmed_V_idea
				TUR_Mehmed_VI_idea
			}
			every_country = {
				limit = { is_subject_of = ROOT OR = { tag = KRS tag = AZR tag = ARM tag = GEO tag = MRC tag = DAG } has_war_with = ENG }
				OVERLORD = { end_puppet = PREV }
				leave_faction = yes
				every_country = {
					limit = { OR = { is_in_faction_with = ENG AND = { is_in_faction_with = FRA NOT = { is_in_faction_with = GER } } } }
					white_peace = PREV
				}
			}
			every_country = {
				limit = {
					has_war_with = ROOT
					NOT = { original_tag = ROOT }
					#NOT = { tag = KRD }
				}
				ROOT = { white_peace = PREV }
			}
			every_country = {
				limit = { is_subject_of = ROOT }
				hidden_effect = { country_event = { id = compiegne_armistice.0 hours = 1 } }
			}
			every_country = {
				limit = { OR = { tag = ENG tag = FRA tag = ITA tag = GRR tag = GRE tag = RUS } OR = { is_in_faction_with = ENG AND = { is_in_faction_with = FRA NOT = { is_in_faction_with = GER } } } }
				PREV = { give_military_access = PREV }
			}
			hidden_effect = {
				country_event = { id = compiegne_armistice.-1 hours = 1 }
			}
			hidden_effect = {
				if = {
					limit = { OR = { has_country_flag = communist_occ has_government = communism } }
					
					clr_country_flag = communist_occ
					if = {
						limit = { NOT = { has_government = communism } }
						set_politics = {
							ruling_party = communism
						}
						add_popularity = {
							ideology = despotism
							popularity = 0.1
						}
						add_popularity = {
							ideology = communism
							popularity = 0.3
						}
					}
				}
			}
		}
		add_threat = -5
		if = {
			limit = { has_idea = TUR_dependent_turkish_economy }
			remove_ideas = TUR_dependent_turkish_economy
		}
		GER = {
			if = {
				limit = { has_idea = GER_dependent_turkish_economy }
				remove_ideas = GER_dependent_turkish_economy
			}
		}
		every_state = {
			limit = { has_dynamic_modifier = { modifier = pan_turanist_agitation } }
			remove_dynamic_modifier = { modifier = pan_turanist_agitation }
		}
		every_state = {
			limit = { has_dynamic_modifier = { modifier = pan_islamic_agitation } }
			remove_dynamic_modifier = { modifier = pan_islamic_agitation }
		}
		RUS = {
			if = {
				limit = { has_country_flag = RUS_occupated_PER_WWI }
				every_state = {
					limit = { is_owned_by = RUS is_core_of = PER NOT = { is_core_of = RUS } }
					PER = { transfer_state = PREV }
				}
				clr_country_flag = RUS_occupated_PER_WWI
			}
		}
	}
}
# Болгария
country_event = {
	id = compiegne_armistice.2
	title = compiegne_armistice.2.t
	desc = compiegne_armistice.2.d
	picture = GFX_report_event_bul_peace_ww1
	
	fire_only_once = yes
	
	immediate = {
		every_country = {
			limit = { OR = { is_subject = no tag = AST tag = SAF tag = CAN tag = NZL } NOT = { has_country_flag = WWI_Entente_member } has_war_with = BUL OR = { is_in_faction_with = ENG is_in_faction_with = FRA } NOT = { is_in_faction_with = GER } NOT = { tag = BUL tag = TUR tag = GER tag = AUH } }
			set_country_flag = WWI_Entente_member
		}
		every_country = {
			limit = { has_country_flag = WWI_Entente_member OR = { NOT = { is_in_faction_with = ENG is_in_faction_with = FRA } is_in_faction_with = GER is_in_faction_with = AUH } }
			clr_country_flag = WWI_Entente_member
		}
		every_country = {
			limit = { NOT = { has_country_flag = WWI_Central_Powers_member } has_war_with = ENG OR = { is_in_faction_with = GER is_in_faction_with = AUH is_in_faction_with = BUL is_in_faction_with = TUR } NOT = { tag = ENG tag = FRA tag = ITA tag = RUS } }
			set_country_flag = WWI_Central_Powers_member
		}
		every_country = {
			limit = { has_country_flag = WWI_Central_Powers_member OR = { is_in_faction_with = ENG has_war_with = GER has_war_with = AUH NOT = { has_war_with = ENG } } }
			clr_country_flag = WWI_Central_Powers_member
		}
		if = {
			limit = { RUS = { has_country_flag = WWI_Entente_member has_country_flag = RUS_monarchy_not_fall has_variable = RUS_otrecheniye } }
			RUS = { add_to_variable = { RUS_otrecheniye = -1 } }
		}
	}
	trigger = {
		tag = BUL
		has_global_flag = WWI_is_now
		NOT = { has_country_flag = BUL_not_cap_yet }
		NOT = { has_global_flag = WWI_BUL_HAS_CAPITULATED }
		OR = {
			has_war_with = ENG
			has_war_with = FRA
		}
		OR = {
			has_capitulated = yes
			NOT = { controls_state = 48 }
			surrender_progress > 0.5
			AND = {
				has_global_flag = WWI_TUR_HAS_CAPITULATED
				surrender_progress > 0.4
			}
			AND = {
				has_global_flag = WWI_GER_HAS_CAPITULATED
				surrender_progress > 0.2
			}
			AND = {
				has_global_flag = WWI_AUH_HAS_CAPITULATED
				surrender_progress > 0.01
			}
		}
	}
	
	mean_time_to_happen = {
		days = 30
		modifier = {
			factor = 0.1
			surrender_progress > 0.12
		}
		modifier = {
			factor = 0.1
			surrender_progress > 0.14
		}
		modifier = {
			factor = 0.1
			surrender_progress > 0.16
		}
		modifier = {
			factor = 0.1
			surrender_progress > 0.18
		}
		modifier = {
			factor = 0.1
			surrender_progress > 0.2
		}
	}
	
	option = {
		name = compiegne_armistice.2.a
		GER = { clr_country_flag = GER_keep_BUL clr_country_flag = flag_GER_BUL_recrute_BUL_generals clr_country_flag = flag_GER_BUL_unite_progerman_opposition }
		set_global_flag = WWI_BUL_HAS_CAPITULATED
		add_ideas = BUL_interunion_commission_idea
		add_ideas = BUL_prisoners_of_war_in_SER_BUL
		SER = { add_ideas = BUL_prisoners_of_war_in_SER_SER }
		if = {
			limit = { has_completed_focus = BUL_desperate_struggle }
			unlock_national_focus = BUL_quest_for_peace
		}
		BUL = {
			clr_country_flag = BUL_claim_on_ALB_1
			clr_country_flag = BUL_claim_on_ALB_2
			clr_country_flag = BUL_claim_on_ALB_3
		}
		hidden_effect = {
			every_state = {
				limit = {
					OR = {
						region = 130
						region = 239
						region = 240
						region = 133
						region = 131
						state = 93
					}
					is_core_of = UKR
					is_owned_by = AUH
				}
				UKR = { transfer_state = PREV }
			}
			every_state = {
				limit = {
					OR = {
						region = 130
						region = 239
						region = 240
						region = 133
						region = 131
						state = 93
					}
					is_core_of = USR
					is_owned_by = AUH
				}
				USR = { transfer_state = PREV }
			}
			if = {
				limit = { owns_state = 240 }
				221 = { OWNER = { transfer_state = 240 } }
			}
			if = {
				limit = { country_exists = CRI }
				every_state = {
					limit = {
						is_owned_by = ROOT
						region = 230
						NOT = { is_core_of = ROOT }
					}
					CRI = { transfer_state = PREV }
				}
				else = {
					random_other_country = {
						limit = { any_owned_state = { region = 230 } }
						every_state = {
							limit = {
								is_owned_by = ROOT
								region = 230
								NOT = { is_core_of = ROOT }
							}
							PREV = { transfer_state = PREV }
						}
					}
				}
			}
		}
		every_state = {
			limit = {
				OR = {
					region = 133
					region = 135
					region = 137
				}
				is_core_of = RUS
				is_owned_by = AUH
			}
			RUS = { transfer_state = PREV }
		}
		BUL = {
			if = {
				limit = {
					any_country = {
						NOT = { tag = BUL }
						is_socialist_country = yes
						count_triggers = { amount = 2 controls_state = 48 controls_state = 987 controls_state = 211 controls_state = 212 controls_state = 945 controls_state = 944 }
					}
				}
				set_country_flag = communist_occ
			}
			every_state = {
				limit = { is_owned_by = PREV region = 25 }
				ENG = { transfer_state = PREV }
			}
			if = {
				limit = { ROM = { NOT = { has_war_with = AUH } } }
				ROM = { leave_faction = yes }
				if = {
					limit = { GER = { is_faction_leader = yes } }
					every_country = {
						limit = { OR = { is_in_faction_with = GER is_in_faction_with = AUH is_in_faction_with = TUR AND = { is_in_faction_with = BUL NOT = { is_in_faction_with = ENG } } } }
						white_peace = ROM
					}
					else = { BUL = { white_peace = ROM } }
				}
			}
			leave_faction = yes
			add_ideas = neutral_foreign_policy_law
			every_country = {
				limit = {
					has_war_with = ROOT
					NOT = { original_tag = ROOT }
				}
				ROOT = { white_peace = PREV }
			}
			every_country = {
				limit = { is_subject_of = ROOT }
				hidden_effect = { country_event = { id = compiegne_armistice.0 hours = 1 } }
			}
			every_country = {
				limit = { OR = { tag = ENG tag = FRA tag = ITA tag = GRR tag = GRE tag = RUS } OR = { is_in_faction_with = ENG AND = { is_in_faction_with = FRA NOT = { is_in_faction_with = GER } } } }
				PREV = { give_military_access = PREV }
			}
			hidden_effect = {
				if = {
					limit = { OR = { has_country_flag = communist_occ has_government = communism } }
					
					clr_country_flag = communist_occ
					if = {
						limit = { NOT = { has_government = communism } }
						set_politics = {
							ruling_party = communism
						}
						add_popularity = {
							ideology = authoritarism
							popularity = -1
						}
						add_popularity = {
							ideology = market_liberalism
							popularity = -0.5
						}
						add_popularity = {
							ideology = communism
							popularity = 0.2
						}
					}
				}
			}
		}
		every_state = {
			limit = { OR = { is_core_of = BUL is_claimed_by = BUL } NOT = { is_owned_by = BUL } }
			remove_claim_by = BUL
			remove_core_of = BUL
		}
		add_threat = -5
		if = {
				limit = { has_idea = BUL_dependent_bulgarian_economy }
				remove_ideas = BUL_dependent_bulgarian_economy
			}
		GER = {
			if = {
				limit = { has_idea = GER_dependent_bulgarian_economy }
				remove_ideas = GER_dependent_bulgarian_economy
			}
		}
	}
}
# Австро-Венгрия
country_event = {
	id = compiegne_armistice.3
	title = compiegne_armistice.3.t
	desc = compiegne_armistice.3.d
	picture = GFX_report_event_auh_peace_ww1
	
	fire_only_once = yes
	
	immediate = {
		every_country = {
			limit = { OR = { is_subject = no tag = AST tag = SAF tag = CAN tag = NZL } NOT = { has_country_flag = WWI_Entente_member } has_war_with = AUH OR = { is_in_faction_with = ENG is_in_faction_with = FRA } NOT = { is_in_faction_with = GER } NOT = { tag = BUL tag = TUR tag = GER tag = AUH } }
			set_country_flag = WWI_Entente_member
		}
		every_country = {
			limit = { has_country_flag = WWI_Entente_member OR = { NOT = { is_in_faction_with = ENG is_in_faction_with = FRA } is_in_faction_with = GER is_in_faction_with = AUH } }
			clr_country_flag = WWI_Entente_member
		}
		every_country = {
			limit = { NOT = { has_country_flag = WWI_Central_Powers_member } has_war_with = ENG OR = { is_in_faction_with = GER is_in_faction_with = AUH is_in_faction_with = BUL is_in_faction_with = TUR } NOT = { tag = ENG tag = FRA tag = ITA tag = RUS } }
			set_country_flag = WWI_Central_Powers_member
		}
		every_country = {
			limit = { has_country_flag = WWI_Central_Powers_member OR = { is_in_faction_with = ENG has_war_with = GER has_war_with = AUH NOT = { has_war_with = ENG } } }
			clr_country_flag = WWI_Central_Powers_member
		}
		if = {
			limit = { RUS = { has_country_flag = WWI_Entente_member has_country_flag = RUS_monarchy_not_fall has_variable = RUS_otrecheniye } }
			RUS = { add_to_variable = { RUS_otrecheniye = -2 } }
		}
	}
	trigger = {
		tag = AUH
		has_global_flag = WWI_is_now
		OR = {
			has_war_with = ENG
			has_war_with = FRA
		}
		OR = {
			AND = {
				has_global_flag = WWI_GER_HAS_CAPITULATED
				surrender_progress > 0.0125
			}
			AND = {
				has_global_flag = WWI_TUR_HAS_CAPITULATED
				surrender_progress > 0.05
			}
			AND = {
				has_stability < 0.3
				surrender_progress > 0.075
			}
			AND = {
				has_stability < 0.25
				surrender_progress > 0.05
			}
			AND = {
				has_stability < 0.2
				surrender_progress > 0.025
			}
			AND = {
				has_stability < 0.15
				surrender_progress > 0.0125
			}
			surrender_progress > 0.1
		}
	}

	fire_only_once = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = compiegne_armistice.3.a
		set_global_flag = WWI_AUH_HAS_CAPITULATED
		leave_faction = yes
		add_ideas = neutral_foreign_policy_law
		ALB = {
			if = {
				limit = {
					any_country = {
						NOT = { tag = ALB }
						controls_state = 44
						is_socialist_country = yes
					}
				}
				set_politics = {
					ruling_party = communism
				}
				add_popularity = {
					ideology = communism
					popularity = 0.2
				}
			}
		}
		CZE = {
			if = {
				limit = {
					any_country = {
						NOT = { tag = CZE }
						OR = { controls_state = 9 controls_state = 75 }
						is_socialist_country = yes
					}
				}
				set_politics = {
					ruling_party = communism
				}
				add_popularity = {
					ideology = communism
					popularity = 0.2
				}
			}
		}
		HUN = {
			if = {
				limit = {
					any_country = {
						NOT = { tag = HUN }
						OR = { controls_state = 43 controls_state = 154 controls_state = 155 }
						is_socialist_country = yes
					}
				}
				set_politics = {
					ruling_party = communism
				}
				add_popularity = {
					ideology = communism
					popularity = 0.2
				}
			}
		}
		SLO = {
			if = {
				limit = {
					any_country = {
						NOT = {
							tag = SLO
							tag = CZE
							tag = HUN
						}
						controls_state = 70
						is_socialist_country = yes
					}
				}
				set_politics = {
					ruling_party = communism
				}
				add_popularity = {
					ideology = communism
					popularity = 0.2
				}
			}
		}
		if = {
			limit = {
				any_country = {
					NOT = {
						tag = AUH
						tag = AUS
					}
					OR = { controls_state = 4 controls_state = 1363 controls_state = 152 }
					is_socialist_country = yes
				}
			}
			add_stability = -1
			add_popularity = {
				ideology = communism
				popularity = 0.3
			}
			add_popularity = {
				ideology = radical_socialism
				popularity = 0.1
			}
			add_popularity = {
				ideology = social_democracy
				popularity = 0.15
			}
			add_popularity = {
				ideology = market_liberalism
				popularity = 0.1
			}
			else = {
				add_stability = -0.25
				add_popularity = {
					ideology = authoritarism
					popularity = -0.5
				}
				add_popularity = {
					ideology = market_liberalism
					popularity = 0.1
				}
				add_popularity = {
					ideology = social_democracy
					popularity = 0.2
				}
			}
		}
		random_country = {
			limit = { owns_state = 984 }
			set_state_owner = 1105
		}
		ALB = {
			set_state_owner = 44
			set_state_owner = 805
			set_state_owner = 1360
		}
		AUH = {
			every_owned_state = {
				limit = { OR = { state = 107 state = 108 state = 948 state = 947 state = 803 state = 1263 state = 802 state = 928 state = 106 state = 993 state = 986 state = 105 state = 1265 } }
				SER = { transfer_state = PREV }
			}
		}
		SER = {
			if = {
				limit = {
					any_country = {
						NOT = { tag = SER }
						OR = { controls_state = 107 controls_state = 108 controls_state = 948 }
						is_socialist_country = yes
					}
				}
				set_politics = {
					ruling_party = communism
				}
				add_popularity = {
					ideology = communism
					popularity = 0.2
				}
			}
			release_puppet = MNT
		}
		if = {
			limit = { ROM = { owns_state = 79 } 78 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 78 }
		}
		if = {
			limit = { ROM = { owns_state = 79 } 766 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 766 }
		}
		if = {
			limit = { ROM = { owns_state = 79 } 1294 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 1294 }
		}
		if = {
			limit = { ROM = { owns_state = 79 } 1307 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 1307 }
		}
		if = {
			limit = { ROM = { owns_state = 79 } 80 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 80 }
		}
		if = {
			limit = { ROM = { owns_state = 79 } 1212 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 1212 }
		}
		if = {
			limit = { ROM = { owns_state = 79 } 972 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 972 }
		}
		if = {
			limit = { ROM = { owns_state = 46 } 1047 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 1047 }
		}
		if = {
			limit = { ROM = { owns_state = 46 } 1046 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 1046 }
		}
		if = {
			limit = { ROM = { owns_state = 81 } 1264 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 1264 }
		}
		if = {
			limit = { ROM = { controls_state = 76 } }
			ROM = { transfer_state = 76 }
		}
		if = {
			limit = { ROM = { controls_state = 84 } }
			ROM = { transfer_state = 84 }
		}
		if = {
			limit = { ROM = { controls_state = 83 OR = { owns_state = 76 owns_state = 84 } } }
			ROM = { transfer_state = 83 transfer_state = 84 }
		}
		if = {
			limit = { ROM = { controls_state = 154 OR = { owns_state = 76 owns_state = 82 owns_state = 83 } } }
			ROM = { transfer_state = 154 transfer_state = 82 transfer_state = 83 }
		}
		if = {
			limit = { ROM = { NOT = { has_war_with = BUL } } }
			ROM = { leave_faction = yes }
			if = {
				limit = { GER = { is_faction_leader = yes } }
				every_country = {
					limit = { OR = { is_in_faction_with = GER is_in_faction_with = AUH is_in_faction_with = TUR AND = { is_in_faction_with = BUL NOT = { is_in_faction_with = ENG } } } }
					white_peace = ROM
				}
				else = { AUH = { white_peace = ROM } }
			}
		}
		CRO = {
			if = {
				limit = {
					any_country = {
						NOT = { tag = CRO }
						is_socialist_country = yes
						OR = { controls_state = 109 controls_state = 104 }
					}
				}
				set_politics = {
					ruling_party = communism
				}
				add_popularity = {
					ideology = communism
					popularity = 0.2
				}
			}
			set_cosmetic_tag = SCS
		}
		AUH = {
			every_owned_state = {
				limit = {
					OR = {
						state = 158
						state = 159
						state = 160
						state = 161
						state = 1032
						state = 1031
						state = 1033
						
						state = 850
						state = 1043
						state = 39
					}
				}
				ITA = { transfer_state = PREV }
			}
		}
		if = {
			limit = { ITA = { controls_state = 103 } }
			ITA = { set_state_owner = 103 }
		}
		else_if = {
			limit = { SER = { controls_state = 103 } }
			SER = { set_state_owner = 103 }
		}
		else = {
			CRO = { transfer_state = 103 }
		}
		if = {
			limit = { ITA = { controls_state = 968 owns_state = 103 } }
			ITA = { set_state_owner = 968 }
		}
		else_if = {
			limit = { SER = { controls_state = 968 owns_state = 104 } }
			SER = { set_state_owner = 968 }
		}
		else = {
			CRO = { transfer_state = 968 }
		}
		if = {
			limit = { ITA = { controls_state = 163 } }
			ITA = { set_state_owner = 163 }
		}
		else_if = {
			limit = { SER = { controls_state = 163 owns_state = 103 } }
			SER = { set_state_owner = 163 }
		}
		else = {
			CRO = { transfer_state = 163 }
		}
		if = {
			limit = { SER = { controls_state = 963 } }
			SER = { set_state_owner = 963 }
			else = { CRO = { transfer_state = 963 } }
		}
		if = {
			limit = { SER = { controls_state = 804 } }
			SER = { set_state_owner = 804 }
			else = { CRO = { transfer_state = 804 } }
		}
		if = {
			limit = { SER = { controls_state = 104 } }
			SER = { set_state_owner = 104 }
			else = { CRO = { transfer_state = 104 } }
		}
		if = {
			limit = { SER = { controls_state = 1374 } }
			SER = { set_state_owner = 1374 }
			else = { CRO = { transfer_state = 1374 } }
		}
		if = {
			limit = { SER = { OR = { controls_state = 45 OR = { owns_state = 1374 owns_state = 963 } } } }
			SER = { set_state_owner = 45 }
		}
		else_if = {
			limit = { AUH = { NOT = { controls_state = 45 } } }
			CRO = { transfer_state = 45 }
		}
		if = {
			limit = { SER = { OR = { owns_state = 45 owns_state = 963 } } }
			SER = { set_state_owner = 962 }
		}
		else_if = {
			limit = { AUH = { NOT = { controls_state = 962 } } }
			CRO = { transfer_state = 962 }
		}
		if = {
			limit = { ITA = { controls_state = 967 } }
			ITA = { set_state_owner = 967 }
			else = { CRO = { transfer_state = 967 } }
		}
		if = {
			limit = { ITA = { controls_state = 853 owns_state = 967 } }
			ITA = { set_state_owner = 853 }
			else = { CRO = { transfer_state = 853 } }
		}
		if = {
			limit = { ITA = { controls_state = 102 owns_state = 967 } }
			ITA = { set_state_owner = 102 }
			else = { CRO = { transfer_state = 102 } }
		}
		if = {
			limit = { ITA = { controls_state = 852 owns_state = 736 } }
			ITA = { set_state_owner = 852 }
		}
		if = {
			limit = { ITA = { controls_state = 966 owns_state = 852 } }
			ITA = { set_state_owner = 966 }
		}
		if = {
			limit = { ITA = { controls_state = 1267 OR = { owns_state = 103 owns_state = 966 } } }
			ITA = { set_state_owner = 1267 }
		}
		else_if = {
			limit = { SER = { controls_state = 1267 OR = { owns_state = 103 owns_state = 104 } } }
			SER = { set_state_owner = 1267 }
		}
		else = {
			CRO = { transfer_state = 1267 }
		}
		if = {
			limit = { SER = { controls_state = 966 owns_state = 1267 } }
			SER = { set_state_owner = 966 }
		}
		if = {
			limit = { ITA = { OR = { controls_state = 736 owns_state = 853 owns_state = 1267 } } }
			ITA = { set_state_owner = 736 }
		}
		else_if = {
			limit = { SER = { owns_state = 853 owns_state = 1267 } }
			SER = { set_state_owner = 736 }
		}
		else = {
			CRO = { transfer_state = 736 }
		}
		if = {
			limit = { ITA = { controls_state = 852 owns_state = 736 } }
			ITA = { set_state_owner = 852 }
		}
		else_if = {
			limit = { SER = { owns_state = 966 } }
			SER = { set_state_owner = 852 }
		}
		else = {
			CRO = { transfer_state = 852 }
		}
		if = {
			limit = { ITA = { controls_state = 966 owns_state = 852 } }
			ITA = { set_state_owner = 966 }
			else = {
				CRO = { transfer_state = 966 }
			}
		}
		if = {
			limit = { ITA = { OR = { owns_state = 967 owns_state = 102 } } }
			ITA = { set_state_owner = 1358 }
			else = { CRO = { transfer_state = 1358 } }
		}
		
		if = {
			limit = { CRO = { OR = { owns_state = 102 owns_state = 853 owns_state = 1267 owns_state = 104 owns_state = 963 } } }
			CRO = { transfer_state = 109 }
			else = { SER = { set_state_owner = 109 } }
		}
		
		if = {
			limit = { controls_state = 10 }
			POL = { set_state_owner = 10 set_state_owner = 87 set_state_owner = 98 set_state_owner = 90 set_state_owner = 1115 set_state_owner = 1117 set_state_owner = 1118 set_state_owner = 1120 }
		}
		every_state = {
			limit = {
				is_controlled_by = ROOT
				OR = {
					region = 38
					state = 92
					state = 904
					state = 1165
				}
			}
			POL = { transfer_state = PREV }
		}
		if = {
			limit = { POL = { owns_state = 10 OR = { owns_state = 87 owns_state = 90 } NOT = { owns_state = 1166 } } }
			POL = { transfer_state = 1166 }
		}
		if = {
			limit = { 88 = { CONTROLLER = { OR = { tag = RUS is_subject_of = RUS } } } }
			RUS = { set_state_owner = 88 }
		}
		if = {
			limit = { 91 = { CONTROLLER = { OR = { tag = RUS is_subject_of = RUS } } } }
			RUS = {
				set_state_owner = 89
				set_state_owner = 91
				set_state_owner = 925
				country_event = { id = rcw_britishseas.11 hours = 1 }
			}
		}
		else = {
			GAL = {
				set_state_owner = 89
				set_state_owner = 91
				set_state_owner = 925
			}
			if = {
				limit = { OR = { 93 = { OR = { is_subject_of = RUS is_owned_by = RUS } } 199 = { OR = { is_subject_of = RUS is_owned_by = RUS } } } }
				RUS = { country_event = { id = rcw_britishseas.12 hours = 1 } }
			}
		}
		
		
		if = {
			limit = { NOT = { has_global_flag = WWI_GER_HAS_CAPITULATED } }
			if = {
				limit = { controls_state = 848 }
				GER = { transfer_state = 848 }
				else = {
					every_country = {
						limit = { controls_state = 848 }
						transfer_state = 848
						GER = { transfer_state = 848 }
					}
				}
			}
			if = {
				limit = { GER = { has_war_with = ITA } }
				if = {
					limit = { controls_state = 153 }
					GER = { transfer_state = 153 }
					else = {
						every_country = {
							limit = { controls_state = 153 }
							transfer_state = 153
							GER = { transfer_state = 153 }
						}
					}
				}
			}
			every_state = {
				limit = {
					is_controlled_by = ROOT
					OR = {
						state = 98
						state = 1118
						state = 1120
						state = 97
						state = 1001
						state = 1119
						state = 87
						state = 1115
						state = 10
						state = 1116
						state = 90
						state = 1117
						state = 92
						state = 904
						state = 1165
						state = 93
						state = 204
						state = 194
						state = 994
						state = 922
					}
				}
				GER = { set_state_controller = PREV }
			}
		}
		
		if = {
			limit = { ROM = { controls_state = 73 } }
			ROM = { set_state_owner = 73 }
		}
		else_if = {
			limit = { OR = { UKR = { controls_state = 73 } AND = { UKR = { exists = yes is_subject_of = RUS } RUS = { controls_state = 73 } } } }
			UKR = { set_state_owner = 73 }
		}
		else_if = {
			limit = { RUS = { controls_state = 73 } }
			RUS = { set_state_owner = 73 }
		}
		if = {
			limit = {
				OR = {
					ROM = { controls_state = 80 }
					GAL = { exists = no }
				}
			}
			ROM = { set_state_owner = 80 }
			else = { GAL = { set_state_owner = 80 } }
		}
			add_ideas = neutral_foreign_policy_law
			every_country = {
				limit = {
					has_war_with = ROOT
					NOT = { original_tag = ROOT }
					NOT = { tag = AUS }
					NOT = { tag = HUN }
					NOT = { tag = AUH }
					NOT = { tag = CZE }
					NOT = { tag = SLO }
				}
				ROOT = { white_peace = PREV }
			}
		every_country = {
			limit = { is_subject_of = ROOT }
			hidden_effect = { country_event = { id = compiegne_armistice.0 hours = 1 } }
		}
		every_country = {
			limit = { OR = { tag = ENG tag = FRA tag = ITA tag = GRR tag = GRE tag = RUS } OR = { is_in_faction_with = ENG AND = { is_in_faction_with = FRA NOT = { is_in_faction_with = GER } } } }
			PREV = { give_military_access = PREV }
		}
		hidden_effect = {
			country_event = { id = compiegne_armistice.-1 hours = 1 }
		}
		hidden_effect = { news_event = { id = news_n.103 hours = 3 } }
		add_ideas = disarmed_nation
		if = {
			limit = { NOT = { has_idea = undisturbed_isolation has_idea = isolation } }
			add_ideas = civilian_economy
		}
		add_threat = -15
		BUL = {
			if = {
				limit = { has_idea = BUL_dependent_bulgarian_economy }
				remove_ideas = BUL_dependent_bulgarian_economy
			}
		}
		GER = {
			if = {
				limit = { has_idea = GER_dependent_bulgarian_economy }
				remove_ideas = GER_dependent_bulgarian_economy
			}
		}
		AUH = {
			every_owned_state = {
				limit = { OR = { is_core_of = FRA } }
				FRA = { transfer_state = PREV }
			}
			every_owned_state = {
				limit = { OR = { is_core_of = SER } }
				SER = { transfer_state = PREV }
			}
			every_owned_state = {
				limit = { OR = { is_core_of = ITA } }
				ITA = { transfer_state = PREV }
			}
			every_owned_state = {
				limit = { OR = { is_core_of = ALB } }
				ALB = { transfer_state = PREV }
			}
		}
	}
	option = {
		trigger = {
			is_ai = no
		}
		name = compiegne_armistice.3.b
	}
}
# Германия
country_event = {
	id = compiegne_armistice.4
	title = compiegne_armistice.4.t
	desc = compiegne_armistice.4.d
	picture = GFX_report_event_germany_civil_war_soldiers
	
	immediate = {
		every_country = {
			limit = { OR = { is_subject = no tag = AST tag = SAF tag = CAN tag = NZL } NOT = { has_country_flag = WWI_Entente_member } has_war_with = GER OR = { is_in_faction_with = ENG is_in_faction_with = FRA } NOT = { is_in_faction_with = GER } NOT = { tag = BUL tag = TUR tag = GER tag = AUH } }
			set_country_flag = WWI_Entente_member
		}
		every_country = {
			limit = { has_country_flag = WWI_Entente_member OR = { NOT = { is_in_faction_with = ENG is_in_faction_with = FRA } is_in_faction_with = GER is_in_faction_with = AUH } }
			clr_country_flag = WWI_Entente_member
		}
		every_country = {
			limit = { NOT = { has_country_flag = WWI_Central_Powers_member } has_war_with = ENG OR = { is_in_faction_with = GER is_in_faction_with = AUH is_in_faction_with = BUL is_in_faction_with = TUR } NOT = { tag = ENG tag = FRA tag = ITA tag = RUS } }
			set_country_flag = WWI_Central_Powers_member
		}
		every_country = {
			limit = { has_country_flag = WWI_Central_Powers_member OR = { is_in_faction_with = ENG has_war_with = GER has_war_with = AUH NOT = { has_war_with = ENG } } }
			clr_country_flag = WWI_Central_Powers_member
		}
		if = {
			limit = { RUS = { has_country_flag = WWI_Entente_member has_country_flag = RUS_monarchy_not_fall has_variable = RUS_otrecheniye } }
			RUS = { add_to_variable = { RUS_otrecheniye = -2 } }
		}
	}

	is_triggered_only = yes
	
	option = {
		name = compiegne_armistice.4.a
		
		set_global_flag = WWI_GER_HAS_CAPITULATED
		
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = GRE tag = GRR }
				}
				OR = { is_core_of = GRE is_core_of = GRR }
				NOT = { is_core_of = ROOT }
			}
			random_other_country = {
				limit = { OR = { tag = GRE tag = GRR } }
				transfer_state = PREV
			}
		}
		every_owned_state = {
			limit = {
				OR = {
					state = 158
					state = 159
					state = 160
					state = 161
					state = 1032
					state = 1031
					state = 1033
					
					state = 850
					state = 1043
					state = 39
				}
			}
			ITA = { transfer_state = PREV }
		}
		if = {
			limit = { has_global_flag = WWI_GRE_HAS_CAPITULATED }
			clr_global_flag = WWI_GRE_HAS_CAPITULATED
		}
		
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = ROM }
				}
				is_core_of = ROM
				NOT = { is_core_of = ROOT }
			}
			ROM = { transfer_state = PREV }
		}
		if = {
			limit = { has_global_flag = WWI_ROM_HAS_CAPITULATED }
			clr_global_flag = WWI_ROM_HAS_CAPITULATED
			ROM = {
				every_owned_state = {
					ROOT = { remove_resource_rights = PREV }
				}
				every_owned_state = {
					set_demilitarized_zone = no
				}
			}
		}
		
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = BUL }
				}
				is_core_of = BUL
				NOT = { is_core_of = ROOT }
			}
			BUL = { transfer_state = PREV }
		}
		if = {
			limit = { has_idea = GER_dependent_bulgarian_economy }
			remove_ideas = GER_dependent_bulgarian_economy
			BUL = { remove_ideas = BUL_dependent_bulgarian_economy }
		}
		
		every_state = {
			limit = {
				is_owned_by = GER
				is_core_of = AUS
				region = 21
			}
			if = {
				limit = { AUH = { exists = yes } }
				AUH = { transfer_state = PREV }
			}
			else_if = {
				limit = { AUS = { exists = yes } }
				AUS = { transfer_state = PREV }
			}
		}
		
		hidden_effect = { if = { limit = { SLT = { NOT = { has_war_with = RUS } OR = { is_subject = no is_subject_of = RUS } } } RUS = { annex_country = { target = SLT transfer_troops = no } } } }
		if = {
			limit = {
				OR = { DON = { exists = yes } 1044 = { OWNER = { OR = { tag = ROOT is_subject_of = ROOT } NOT = { tag = DON tag = UKR } } } 218 = { OWNER = { OR = { tag = ROOT is_subject_of = ROOT } NOT = { tag = DON tag = UKR } } } }
			}
			every_state = {
				limit = {
					OWNER = {
						OR = {
							tag = ROOT
							is_subject_of = ROOT
						}
						NOT = { tag = DON tag = UKR }
					}
					is_core_of = DON
					NOT = { is_core_of = ROOT }
				}
				DON = { transfer_state = PREV }
			}
			else = {
				every_state = {
					limit = {
						OWNER = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
							NOT = { tag = DON tag = UKR }
						}
						is_core_of = DON
						NOT = { is_core_of = ROOT }
					}
					1044 = { OWNER = { transfer_state = PREV.PREV } }
				}
			}
		}
		if = {
			limit = {
				has_country_flag = DON_partner
			}
			remove_ideas = DON_postavki_in
			remove_opinion_modifier = {
				target = DON
				modifier = DON_bread_trade
			}
			DON = {
				remove_ideas = DON_postavki_out
				remove_opinion_modifier = {
					target = ROOT
					modifier = DON_bread_trade
				}
			}
			DON = { remove_ideas = foreing_credit_for_DON }
			clr_country_flag = DON_partner
		}
		
		if = {
			limit = { UKR = { is_subject_of = ROOT } }
			end_puppet = UKR
			UKR = { remove_ideas = UKR_zerno_in }
			remove_ideas = UKR_zerno_out
			UKR = {
				leave_faction = yes
				remove_ideas = help_from_foreign_interventionists
				every_country = {
					limit = { OR = { tag = ENG tag = USA is_in_faction_with = ENG is_in_faction_with = USA AND = { OR = { is_in_faction_with = FRA tag = FRA } NOT = { is_in_faction_with = GER } } } }
					white_peace = PREV
				}
				every_enemy_country = {
					limit = { tag = NVA }
					white_peace = PREV
				}
				every_country = {
					limit = { OR = { tag = GEO tag = ARM tag = AZR tag = BAK } }
					white_peace = PREV
				}
			}
		}
		
		if = {
			limit = { TUR = { NOT = { has_war_with = RUS OR = { 230 = { OWNER = { OR = { tag = RUS tag = TUR is_subject_of = TUR } } } 899 = { OWNER = { OR = { tag = RUS tag = TUR is_subject_of = TUR } } } } } } }
			every_state = {
				limit = {
					OWNER = {
						OR = {
							tag = ROOT
							is_subject_of = ROOT
						}
						NOT = { tag = KRS tag = TUR tag = AZR tag = GEO tag = ARM tag = PER tag = PER tag = CHC tag = DAG tag = MRC }
					}
					is_core_of = TUR
					region = 134
					NOT = { is_core_of = ROOT }
				}
				add_core_of = KRS
			}
			every_state = {
				limit = {
					OWNER = {
						OR = {
							tag = ROOT
							is_subject_of = ROOT
						}
						NOT = { tag = KRS tag = TUR tag = AZR tag = GEO tag = ARM tag = PER tag = PER tag = CHC tag = DAG tag = MRC }
					}
					is_core_of = KRS
					NOT = { is_core_of = ROOT }
				}
				KRS = { transfer_state = PREV }
			}
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = KRS tag = TUR tag = AZR tag = GEO tag = ARM tag = PER tag = PER tag = CHC tag = DAG tag = MRC }
				}
				is_core_of = TUR
				NOT = { is_core_of = ROOT }
			}
			TUR = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = KRS tag = TUR tag = AZR tag = GEO tag = ARM tag = PER tag = PER tag = CHC tag = DAG tag = MRC }
				}
				is_core_of = AZR
				NOT = { is_core_of = ROOT }
			}
			AZR = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = KRS tag = TUR tag = AZR tag = GEO tag = ARM tag = PER tag = PER tag = CHC tag = DAG tag = MRC }
				}
				is_core_of = GEO
				NOT = { is_core_of = ROOT }
			}
			GEO = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = KRS tag = TUR tag = AZR tag = GEO tag = ARM tag = PER tag = PER tag = CHC tag = DAG tag = MRC }
				}
				is_core_of = ARM
				NOT = { is_core_of = ROOT }
			}
			ARM = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = KRS tag = TUR tag = AZR tag = GEO tag = ARM tag = PER tag = PER tag = CHC tag = DAG tag = MRC }
				}
				is_core_of = PER
				NOT = { is_core_of = ROOT }
			}
			PER = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = KRS tag = TUR tag = AZR tag = GEO tag = ARM tag = PER tag = PER tag = CHC tag = DAG tag = MRC }
				}
				is_core_of = CHC
				NOT = { is_core_of = ROOT }
			}
			CHC = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = KRS tag = TUR tag = AZR tag = GEO tag = ARM tag = PER tag = PER tag = CHC tag = DAG tag = MRC }
				}
				is_core_of = DAG
				NOT = { is_core_of = ROOT }
			}
			DAG = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = KRS tag = TUR tag = AZR tag = GEO tag = ARM tag = PER tag = PER tag = CHC tag = DAG tag = MRC }
				}
				region = 134
				NOT = { is_core_of = ROOT }
			}
			MRC = { transfer_state = PREV }
		}
		
		hidden_effect = { end_puppet = CRI }
		if = {
			limit = { any_state = { is_core_of = CRI OWNER = { OR = { tag = ROOT is_subject_of = ROOT } } } }
			CRI = {
				every_unit_leader = { limit = { OR = { has_id = 100002 has_id = 100001 } } set_nationality = REB }
				set_politics = {
					ruling_party = market_liberalism
				}
				add_popularity = {
					ideology = market_liberalism
					popularity = 0.1
				}
				remove_ideas_with_trait = minister_flag_trait
				set_country_flag = CRI_second_gov
				load_focus_tree = Crimea_focus_tree
				mark_focus_tree_layout_dirty = yes
				add_stability = -0.05
				add_ideas = CRI_red_partisans
				RVA = { country_event = { id = rcw_crimea.39 days = 1 } }
				if = {
					limit = { NOT = { has_global_flag = WWI_FRA_HAS_CAPITULATED } }
					FRA = { country_event = { id = rcw_crimea.40 days = 1 } }
				}
				remove_ideas = help_from_foreign_interventionists
				if = {
					limit = { has_idea = FRA_disjointed_government }
					remove_ideas = FRA_disjointed_government
				}
				retire_ideology_leader = authoritarism
				set_party_name = {
					ideology = authoritarism
					long_name = CRI_authoritarism_second_long
					name = CRI_authoritarism_second
				}
				create_country_leader = { name = "Sergey Romanovskiy" desc = CRI_Sergey_Romanovskiy_desc picture = "gfx/leaders/CRI/portrait_Sergey_Romanovskiy.dds" ideology = authoritarism_ideology traits = { inexperienced_monarch } }
				GER = { remove_from_array = { rcw_supported_states = FROM.id } }
				TUR = { remove_from_array = { rcw_supported_states = FROM.id } }
				AUH = { remove_from_array = { rcw_supported_states = FROM.id } }
			}
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = CRI tag = UKR }
				}
				is_core_of = CRI
				NOT = { is_core_of = ROOT }
			}
			CRI = { transfer_state = PREV }
		}
		
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = TRK tag = BUK tag = KHI tag = SCH tag = SIB tag = KAZ }
				}
				is_core_of = TRK
				NOT = { is_core_of = ROOT }
			}
			TRK = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = TRK tag = BUK tag = KHI tag = SCH tag = SIB tag = KAZ }
				}
				is_core_of = BUK
				NOT = { is_core_of = ROOT }
			}
			BUK = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = TRK tag = BUK tag = KHI tag = SCH tag = SIB tag = KAZ }
				}
				is_core_of = KHI
				NOT = { is_core_of = ROOT }
			}
			KHI = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = TRK tag = BUK tag = KHI tag = SCH tag = SIB tag = KAZ }
				}
				is_core_of = SCH
				NOT = { is_core_of = ROOT }
			}
			SCH = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = TRK tag = BUK tag = KHI tag = SCH tag = SIB tag = KAZ }
				}
				is_core_of = SIB
				NOT = { is_core_of = ROOT }
			}
			SIB = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = TRK tag = BUK tag = KHI tag = SCH tag = SIB tag = KAZ }
				}
				is_core_of = KAZ
				NOT = { is_core_of = ROOT }
			}
			KAZ = { transfer_state = PREV }
		}
		
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = TAN }
				}
				is_core_of = TAN
				NOT = { is_core_of = ROOT }
			}
			TAN = { transfer_state = PREV }
		}
		
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = BYA tag = BLK tag = AMR tag = PRM tag = ZKL }
				}
				is_core_of = BYA
				NOT = { is_core_of = ROOT }
			}
			BYA = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = BYA tag = BLK tag = AMR tag = PRM tag = ZKL }
				}
				is_core_of = BLK
				NOT = { is_core_of = ROOT }
			}
			BLK = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = BYA tag = BLK tag = AMR tag = PRM tag = ZKL }
				}
				is_core_of = AMR
				NOT = { is_core_of = ROOT }
			}
			AMR = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = BYA tag = BLK tag = AMR tag = PRM tag = ZKL }
				}
				is_core_of = PRM
				NOT = { is_core_of = ROOT }
			}
			PRM = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = BYA tag = BLK tag = AMR tag = PRM tag = ZKL }
				}
				is_core_of = ZKL
				NOT = { is_core_of = ROOT }
			}
			ZKL = { transfer_state = PREV }
		}
		
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = RVA tag = DON tag = MCW tag = RUS tag = UKR }
				}
				region = 135
				NOT = { is_core_of = ROOT }
			}
			if = {
				limit = { RVA = { exists = yes } }
				RVA = { transfer_state = PREV }
			}
			else_if = {
				limit = { DON = { exists = yes } }
				DON = { transfer_state = PREV }
			}
			else_if = {
				limit = { MCW = { exists = yes } }
				MCW = { transfer_state = PREV }
			}
			else = {
				RUS = { transfer_state = PREV }
			}
		}
		every_state = {
			limit = {
				is_owned_by = GER
				OR = {
					region = 238
					region = 147
					region = 148
					region = 149
					region = 14
					region = 155
					region = 229
				}
				NOT = { is_core_of = ROOT }
			}
			if = {
				limit = { SIB = { exists = yes } }
				SIB = { transfer_state = PREV }
			}
			else_if = {
				limit = { RSS = { exists = yes } }
				RSS = { transfer_state = PREV }
			}
			else_if = {
				limit = { CCA = { exists = yes } }
				CCA = { transfer_state = PREV }
			}
			else = {
				RUS = { transfer_state = PREV }
			}
		}
		every_state = {
			limit = {
				is_owned_by = GER
				region = 136
				NOT = { is_core_of = ROOT }
			}
			if = {
				limit = { TRK = { exists = yes } }
				TRK = { transfer_state = PREV }
			}
			else_if = {
				limit = { KAZ = { exists = yes } }
				KAZ = { transfer_state = PREV }
			}
			else_if = {
				limit = { CCA = { exists = yes } }
				CCA = { transfer_state = PREV }
			}
			else_if = {
				limit = { SIB = { exists = yes } }
				SIB = { transfer_state = PREV }
			}
			else_if = {
				limit = { RSS = { exists = yes } }
				RSS = { transfer_state = PREV }
			}
			else = {
				RUS = { transfer_state = PREV }
			}
		}
		every_state = {
			limit = {
				is_owned_by = GER
				OR = {
					region = 151
					region = 138
				}
				NOT = { is_core_of = ROOT }
			}
			if = {
				limit = { CCA = { exists = yes } }
				CCA = { transfer_state = PREV }
			}
			else_if = {
				limit = { SIB = { exists = yes } }
				SIB = { transfer_state = PREV }
			}
			else_if = {
				limit = { RSS = { exists = yes } }
				RSS = { transfer_state = PREV }
			}
			else = {
				RUS = { transfer_state = PREV }
			}
		}
		
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = LIT tag = LAT tag = BLR tag = POL tag = UKR tag = UBD }
				}
				OR = {
					state = 784
					state = 998
					state = 95
					state = 956
					state = 1024
					state = 97
					state = 910
					state = 1366
					state = 814
					state = 11
					state = 189
					state = 999
					state = 815
					is_core_of = LIT
				}
				NOT = { is_core_of = ROOT }
			}
			LIT = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = LIT tag = LAT tag = EST tag = BLR tag = POL tag = UKR tag = UBD }
				}
				is_core_of = LAT
				NOT = { state = 809 }
				NOT = { state = 1351 }
				NOT = { is_core_of = ROOT }
			}
			LAT = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = LIT tag = LAT tag = EST tag = BLR tag = POL tag = UKR tag = UBD }
				}
				is_core_of = EST
				NOT = { state = 1004 }
				NOT = { is_core_of = ROOT }
			}
			EST = { transfer_state = PREV }
		}
		if = {
			limit = { owns_state = 809 OR = { country_exists = UBD country_exists = LAT } }
			12 = { OWNER = { transfer_state = 809 } }
		}
		if = {
			limit = { owns_state = 1351 OR = { country_exists = UBD country_exists = LAT } }
			12 = { OWNER = { transfer_state = 1351 } }
		}
		if = {
			limit = { owns_state = 1004 OR = { country_exists = UBD country_exists = EST } }
			191 = { OWNER = { transfer_state = 1004 } }
		}
		
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
						tag = AUH
						is_subject_of = AUH
					}
					NOT = { tag = LIT tag = LAT tag = EST tag = BLR tag = POL tag = UKR tag = UBD }
				}
				OR = {
					region = 38
					state = 92
					state = 904
					state = 1165
				}
				is_core_of = POL
				NOT = { is_core_of = ROOT }
				NOT = { is_core_of = AUH }
			}
			POL = { transfer_state = PREV }
		}
		
		every_state = {
			limit = {
				OR = {
					AND = {
						OR = {
							region = 39
							region = 133
						}
						OR = {
							is_core_of = UKR
							is_claimed_by = UKR
						}
					}
					region = 130
					region = 239
					region = 240
				}
				is_owned_by = GER
			}
			UKR = { transfer_state = PREV }
		}
			if = {
				limit = { owns_state = 240 }
				221 = { OWNER = { transfer_state = 240 } }
			}
		every_state = {
			limit = {
				OWNER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
					}
					NOT = { tag = LIT tag = LAT tag = EST tag = BLR tag = POL tag = UKR tag = UBD }
				}
				is_core_of = BLR
				NOT = { is_core_of = ROOT }
			}
			BLR = { transfer_state = PREV }
		}
		
		if = {
			limit = {
				OR = {
					owns_state = 195
					owns_state = 219
				}
			}
			every_state = {
				limit = {
					is_owned_by = GER
					NOT = { is_core_of = GER }
					is_core_of = RUS
					NOT = { region = 130 region = 239 region = 240 state = 240 region = 134 region = 135 }
				}
				add_core_of = MCW
				MCW = { transfer_state = PREV }
			}
		}
		
		if = {
			limit = { has_war_with = RUS }
			
			if = {
				limit = { 651 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } }
				BSK = {
					if = {
						limit = { OR = { exists = no is_subject_of = ROOT } }
						set_country_flag = WWI_post_german_russia_collaborators_new_country_BSK_TAT_CHU
					}
					if = {
						limit = { OR = { exists = no has_army_manpower = { size < 1000 } } }
						set_country_flag = WWI_post_german_russia_collaborators_has_no_army
					}
				}
				every_state = {
					limit = {
						CONTROLLER = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
						}
						OWNER = { NOT = { is_subject_of = ROOT } }
						is_controlled_by = ROOT
						is_core_of = BSK
						NOT = { is_core_of = ROOT }
					}
					BSK = { transfer_state = PREV }
				}
			}
			if = {
				limit = { 249 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } }
				TAT = {
					if = {
						limit = { OR = { exists = no is_subject_of = ROOT } }
						set_country_flag = WWI_post_german_russia_collaborators_new_country_BSK_TAT_CHU
					}
					if = {
						limit = { OR = { exists = no has_army_manpower = { size < 1000 } } }
						set_country_flag = WWI_post_german_russia_collaborators_has_no_army
					}
				}
				every_state = {
					limit = {
						CONTROLLER = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
						}
						OWNER = { NOT = { is_subject_of = ROOT } }
						is_controlled_by = ROOT
						is_core_of = TAT
						NOT = { is_core_of = ROOT }
					}
					TAT = { transfer_state = PREV }
				}
			}
			if = {
				limit = { 256 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } }
				CHU = {
					if = {
						limit = { OR = { exists = no is_subject_of = ROOT } }
						set_country_flag = WWI_post_german_russia_collaborators_new_country_BSK_TAT_CHU
					}
					if = {
						limit = { OR = { exists = no has_army_manpower = { size < 1000 } } }
						set_country_flag = WWI_post_german_russia_collaborators_has_no_army
					}
				}
				every_state = {
					limit = {
						CONTROLLER = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
						}
						OWNER = { NOT = { is_subject_of = ROOT } }
						is_controlled_by = ROOT
						is_core_of = CHU
						NOT = { is_core_of = ROOT }
					}
					CHU = { transfer_state = PREV }
				}
			}
			if = {
				limit = {
					NOT = {
						any_state = {
							region = 230
							CONTROLLER = { NOT = { tag = ROOT is_subject_of = ROOT } }
						}
					}
				}
				CRI = {
					if = {
						limit = { OR = { exists = no is_subject_of = ROOT } }
						set_country_flag = WWI_post_german_russia_collaborators_new_country_CRI
					}
					if = {
						limit = { OR = { exists = no has_army_manpower = { size < 1000 } } }
						set_country_flag = WWI_post_german_russia_collaborators_has_no_army
					}
				}
				every_state = {
					limit = {
						CONTROLLER = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
						}
						OWNER = { NOT = { is_subject_of = ROOT } }
						is_controlled_by = ROOT
						is_core_of = CRI
						NOT = { is_core_of = ROOT }
					}
					CRI = { transfer_state = PREV }
				}
			}
			
			if = {
				limit = { 218 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } 1044 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } }
				DON = {
					if = {
						limit = { OR = { exists = no is_subject_of = ROOT } }
						set_country_flag = WWI_post_german_russia_collaborators_new_country_DON
					}
					if = {
						limit = { OR = { exists = no has_army_manpower = { size < 1000 } } }
						set_country_flag = WWI_post_german_russia_collaborators_has_no_army
					}
				}
				every_state = {
					limit = {
						CONTROLLER = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
						}
						OWNER = { NOT = { is_subject_of = ROOT } }
						is_controlled_by = ROOT
						is_core_of = DON
						NOT = { is_core_of = ROOT }
					}
					DON = { transfer_state = PREV }
				}
			}
			
			if = {
				limit = { 812 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } 813 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } 191 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } }
				EST = {
					if = {
						limit = { OR = { exists = no is_subject_of = ROOT } }
						set_country_flag = WWI_post_german_russia_collaborators_new_country_EST_LAT_LIT
					}
					if = {
						limit = { OR = { exists = no has_army_manpower = { size < 1000 } } }
						set_country_flag = WWI_post_german_russia_collaborators_has_no_army
					}
				}
				every_state = {
					limit = {
						CONTROLLER = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
						}
						OWNER = { NOT = { is_subject_of = ROOT } }
						is_core_of = EST
						NOT = { is_core_of = ROOT }
					}
					EST = { transfer_state = PREV }
				}
			}
			if = {
				limit = { 12 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } 12 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } 809 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } }
				LAT = {
					if = {
						limit = { OR = { exists = no is_subject_of = ROOT } }
						set_country_flag = WWI_post_german_russia_collaborators_new_country_EST_LAT_LIT
					}
					if = {
						limit = { OR = { exists = no has_army_manpower = { size < 1000 } } }
						set_country_flag = WWI_post_german_russia_collaborators_has_no_army
					}
				}
				every_state = {
					limit = {
						CONTROLLER = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
						}
						OWNER = { NOT = { is_subject_of = ROOT } }
						is_core_of = LAT
						NOT = { is_core_of = ROOT }
					}
					LAT = { transfer_state = PREV }
				}
			}
			if = {
				limit = { 784 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } 11 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } 189 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } 815 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT } } } }
				LIT = {
					if = {
						limit = { OR = { exists = no is_subject_of = ROOT } }
						set_country_flag = WWI_post_german_russia_collaborators_new_country_EST_LAT_LIT
					}
					if = {
						limit = { OR = { exists = no has_army_manpower = { size < 1000 } } }
						set_country_flag = WWI_post_german_russia_collaborators_has_no_army
					}
				}
				every_state = {
					limit = {
						CONTROLLER = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
						}
						OWNER = { NOT = { is_subject_of = ROOT } }
						OR = {
							is_core_of = LIT
							state = 998
							state = 95
							state = 1024
							state = 910
							state = 956
							state = 97
						}
						NOT = { is_core_of = ROOT }
					}
					LIT = { transfer_state = PREV }
				}
			}
			if = {
				limit = { 10 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT is_in_faction_with = ROOT } } } 87 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT is_in_faction_with = ROOT } } } 90 = { CONTROLLER = { OR = { tag = ROOT is_subject_of = ROOT is_in_faction_with = ROOT } } } }
				POL = {
					if = {
						limit = { OR = { exists = no has_army_manpower = { size < 1000 } } }
						set_country_flag = WWI_post_german_russia_collaborators_has_no_army
					}
				}
				every_state = {
					limit = {
						OR = {
							region = 38
							state = 92
							state = 904
							state = 1165
						}
						CONTROLLER = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
						}
						OWNER = { NOT = { is_subject_of = ROOT } }
						is_core_of = POL
						NOT = { is_core_of = ROOT }
					}
					POL = { transfer_state = PREV }
				}
				every_state = {
					limit = {
						OR = {
							region = 38
							state = 92
							state = 904
							state = 1165
						}
						CONTROLLER = {
							OR = {
								tag = AUH
								is_subject_of = AUH
							}
						}
						OWNER = { NOT = { is_subject_of = AUH } }
						is_core_of = POL
						NOT = { is_core_of = AUH }
					}
					POL = { transfer_state = PREV }
				}
				else = {
					hidden_effect = { RUS = { annex_country = { target = POL transfer_troops = no } } }
				}
			}
			
			every_country = {
				limit = { has_country_flag = WWI_post_german_russia_collaborators_has_no_army }
				if = {
					limit = { tag = BSK }
					load_oob = BSK_1918_CCA_autonomy
				}
				if = {
					limit = { tag = TAT }
					load_oob = TAT_1918_CCA_autonomy
				}
				if = {
					limit = { tag = CHU }
					load_oob = CHU_1918_CCA_autonomy
				}
				if = {
					limit = { tag = CRI }
					load_oob = CRI_1918
				}
				if = {
					limit = { tag = DON }
					load_oob = DON_Cossack_mob
				}
				if = {
					limit = { tag = EST }
					country_event = rcw_bfk.3
				}
				if = {
					limit = { tag = LAT }
					country_event = rcw_bfk.11
				}
				if = {
					limit = { tag = LIT }
					country_event = rcw_bfk.163
					country_event = rcw_bfk.164
					country_event = rcw_bfk.168
				}
				if = {
					limit = { tag = POL }
					country_event = { id = poland.1 hours = 2 }
				}
				clr_country_flag = WWI_post_german_russia_collaborators_has_no_army
			}
			
			if = {
				limit = { any_country = { has_country_flag = WWI_post_german_russia_collaborators_new_country_BSK_TAT_CHU } }
				RUS = { country_event = { id = rcw_britishseas.1 days = 1 } }
			}
			if = {
				limit = { any_country = { has_country_flag = WWI_post_german_russia_collaborators_new_country_CRI } }
				RUS = { country_event = { id = rcw_britishseas.2 days = 1 } }
			}
			if = {
				limit = { any_country = { has_country_flag = WWI_post_german_russia_collaborators_new_country_DON } }
				RUS = { country_event = { id = rcw_britishseas.3 days = 1 } }
			}
			if = {
				limit = { any_country = { has_country_flag = WWI_post_german_russia_collaborators_new_country_EST_LAT_LIT } }
				RUS = { country_event = { id = rcw_britishseas.4 days = 1 } }
			}
			if = {
				limit = { country_exists = POL any_country = { has_country_flag = WWI_post_german_russia_collaborators_new_country_EST_LAT_LIT } }
				RUS = { set_country_flag = WWI_post_german_russia_collaborators_new_country_POL }
			}
			if = {
				limit = { country_exists = POL NOT = { any_country = { has_country_flag = WWI_post_german_russia_collaborators_new_country_EST_LAT_LIT } } }
				RUS = { country_event = { id = rcw_britishseas.5 days = 1 } }
			}
			
			RUS = {
				if = {
					limit = { NOT = { controls_state = 763 } }
					set_country_flag = RUS_does_not_take_Prussia
				}
			}
			every_state = {
				limit = {
					is_owned_by = GER
					OR = {
						state = 188
						state = 763
						state = 5
						state = 1379
						state = 1000
						state = 85
						state = 807
						state = 1271
						state = 86
					}
				}
				RUS = { transfer_state = PREV }
			}
			RUS = {
				if = {
					limit = { NOT = { controls_state = 10 } }
					every_owned_state = {
						limit = {
							is_core_of = PRE
							is_core_of = POL
							CONTROLLER = {
								NOT = { tag = ROOT is_subject_of = ROOT is_in_faction_with = ROOT }
							}
						}
						POL = { transfer_state = PREV }
					}
				}
			}
			RUS = {
				if = {
					limit = { has_country_flag = RUS_does_not_take_Prussia }
					clr_country_flag = RUS_does_not_take_Prussia
					every_owned_state = {
						limit = {
							is_core_of = PRE
							CONTROLLER = {
								NOT = { tag = ROOT is_subject_of = ROOT is_in_faction_with = ROOT }
							}
						}
						PRE = { transfer_state = PREV }
					}
					PRE = { add_ideas = neutral_foreign_policy_law inherit_technology = GER }
					country_event = { id = rcw_britishseas.6 days = 3 }
					GER = { country_event = rcw_britishseas.7 }
				}
			}
		}
		
		
		every_state = {
			limit = { is_owned_by = GER is_core_of = BEL }
			BEL = { transfer_state = PREV }
		}
		every_state = {
			limit = { is_owned_by = GER is_core_of = FRA NOT = { state = 28 } }
			FRA = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = { OR = { tag = GER is_subject_of = GER } }
				NOT = { is_controlled_by = GER }
				OR = {
					region = 97
					region = 84
					region = 94
					region = 83
					region = 78
					region = 167
					region = 143
				}
			}
			CONTROLLER = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = { OR = { tag = GER is_subject_of = GER } }
				OR = {
					state = 1233
					state = 1007
					state = 1009
					state = 1008
					state = 546
				}
			}
			ENG = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = { OR = { tag = GER is_subject_of = GER } }
				OR = {
					region = 139
					region = 215
				}
			}
			SAF = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = { OR = { tag = GER is_subject_of = GER } }
				OR = {
					region = 140
					region = 184
				}
			}
			FRA = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = { OR = { tag = GER is_subject_of = GER } }
				is_controlled_by = BEL
				is_on_continent = africa
			}
			BEL = { transfer_state = PREV }
		}
		every_state = {
			limit = {
				OWNER = { OR = { tag = GER is_subject_of = GER } }
				OR = {
					state = 768
					state = 769
				}
			}
			ENG = { transfer_state = PREV }
		}
		hidden_effect = {
			every_country = {
				limit = {
					OR = {
						tag = OAF
						tag = ZAF
						tag = WAF
						tag = SAF
					}
					is_subject_of = GER
				}
				ENG = {
					annex_country = {
						target = PREV
						transfer_troops = no
					}
				}
			}
		}
		every_state = {
			limit = {
				OWNER = { OR = { tag = GER is_subject_of = GER } }
				is_on_continent = africa
			}
			ENG = { transfer_state = PREV }
		}
		
		if = {
			limit = {
				RUS = {
					has_war_with = ROOT
					OR = {
						is_in_faction = no
						is_faction_leader = yes
					}
				}
			}
			RUS = { country_event = { id = treaty_of_brest.1917 hours = 2 } }
		}
		
		if = {
			limit = {
				OR = {
					has_global_flag = brest_litovsk_negotiations
					has_global_flag = brest_litovsk_negotiations_GER_UKR_peace
					has_global_flag = brest_litovsk_GER_UKR_negotiations
					has_global_flag = russia_rejects_german_ultimatum
					has_global_flag = GER_average_peace_brest_tech_flag
					has_global_flag = GER_average_peace_brest_alt_demand_tech_flag
				}
			}
			clr_global_flag = brest_litovsk_negotiations
			clr_global_flag = brest_litovsk_negotiations_GER_UKR_peace
			clr_global_flag = brest_litovsk_GER_UKR_negotiations
			clr_global_flag = russia_rejects_german_ultimatum
			clr_global_flag = GER_average_peace_brest_tech_flag
			clr_global_flag = GER_average_peace_brest_alt_demand_tech_flag
		}
		
		
		add_ideas = neutral_foreign_policy_law
		clr_country_flag = WWI_GER_last_teutonic_advance
		add_threat = -30
		if = { limit = { 28 = { is_owned_by = GER is_controlled_by = FRA } } FRA = { transfer_state = 28 } }
		every_country = {
			limit = { is_in_faction_with = GER NOT = { tag = GER tag = AUH tag = BUL tag = TUR tag = GAL tag = POL } is_subject = no }
			leave_faction = yes
			every_country = {
				limit = { OR = { tag = ENG is_in_faction_with = ENG AND = { is_in_faction_with = FRA NOT = { is_in_faction_with = GER } } } }
				white_peace = PREV
			}
			every_country = {
				limit = { OR = { tag = GEO tag = ARM tag = AZR tag = BAK } }
				white_peace = PREV
			}
		}
		every_country = {
			limit = { is_subject_of = ROOT }
			hidden_effect = { country_event = { id = compiegne_armistice.0 hours = 1 } }
		}
		leave_faction = yes
		if = {
			limit = {
				any_country = {
					NOT = { tag = GER }
					is_socialist_country = yes
					count_triggers = { amount = 9 controls_state = 66 controls_state = 763 controls_state = 68 controls_state = 64 controls_state = 65 controls_state = 60 controls_state = 1266 controls_state = 51 controls_state = 42 controls_state = 54 controls_state = 52 controls_state = 1382 controls_state = 61 controls_state = 67 controls_state = 59 controls_state = 57 controls_state = 85 }
				}
			}
			set_country_flag = communist_occ
			else = {
				if = {
					limit = {
						any_country = {
							NOT = { tag = GER }
							is_socialist_country = yes
							OR = { controls_state = 66 controls_state = 763 controls_state = 68 controls_state = 64 controls_state = 65 controls_state = 60 controls_state = 1266 controls_state = 51 controls_state = 42 controls_state = 54 controls_state = 52 controls_state = 1382 controls_state = 61 controls_state = 67 controls_state = 59 controls_state = 57 controls_state = 85 }
						}
					}
					every_state = {
						limit = {
							is_owned_by = GER
							CONTROLLER = { is_socialist_country = yes NOT = { tag = GER } }
						}
						DDR = { transfer_state = PREV }
					}
				}
			}
		}
		
		add_ideas = disarmed_nation
		if = {
			limit = { NOT = { has_idea = undisturbed_isolation has_idea = isolation } }
			add_ideas = civilian_economy
		}
		
			every_country = {
				limit = {
					has_war_with = ROOT
					NOT = { original_tag = ROOT }
					NOT = { tag = BAY }
					NOT = { tag = LIT }
					NOT = { tag = POL }
					NOT = { tag = GAL }
					NOT = { tag = LAT }
					NOT = { tag = EST }
					NOT = { tag = BLR }
					NOT = { tag = SLT }
				}
				ROOT = { white_peace = PREV }
			}
		
		hidden_effect = {
			country_event = { id = compiegne_armistice.-1 hours = 1 }
		}
		1117 = {
			owner = { transfer_state = 762 } #Каттовиц
		}
		1115 = {
			owner = { transfer_state = 86 } #Познань
		}
	}
	option = {
		trigger = {
			is_ai = no
		}
		name = compiegne_armistice.4.b
	}
}

# Мир Османии и Антанты в случае лимита капитуляции 0
country_event = {
	id = compiegne_armistice.5
	title = compiegne_armistice.5.t
	desc = compiegne_armistice.5.d
	picture = GFX_report_event_ott_peace_ww1
	
	trigger = {
		tag = TUR
		has_global_flag = WWI_is_now
		OR = {
			has_global_flag = WWI_GER_HAS_CAPITULATED
			NOT = { is_in_faction_with = GER }
		}
		NOT = { has_global_flag = WWI_TUR_HAS_CAPITULATED }
		NOT = { surrender_progress > 0 }
		OR = {
			has_war_with = ENG
			has_war_with = FRA
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	fire_only_once = yes
	
	option = {
		name = compiegne_armistice.5.a
		TUR = {
			leave_faction = yes
			add_ideas = neutral_foreign_policy_law
		}
		every_state = {
			limit = {
				is_on_continent = middle_east
				OR = {
					is_controlled_by = TUR
					is_controlled_by = TUR
				}
				OR = {
					is_owned_by = ENG
					state = 453
				}
			}
			TUR = { transfer_state = PREV }
		}
			every_country = {
				limit = {
					has_war_with = ROOT
					NOT = { original_tag = ROOT }
					#NOT = { tag = KRD }
				}
				ROOT = { white_peace = PREV }
			}
		RUS = {
			if = {
				limit = { has_country_flag = RUS_occupated_PER_WWI }
				every_state = {
					limit = { is_owned_by = RUS is_core_of = PER NOT = { is_core_of = RUS } }
					PER = { transfer_state = PREV }
				}
				clr_country_flag = RUS_occupated_PER_WWI
			}
			if = {
				limit = { has_war_with = TUR has_country_flag = RUS_monarchy_not_fall has_variable = RUS_otrecheniye }
				RUS = { add_to_variable = { RUS_otrecheniye = -1 } }
			}
		}
	}
}

# Мир Османии и Антанты в случае лимита капитуляции более 10 и не более 40
country_event = {
	id = compiegne_armistice.6
	title = compiegne_armistice.6.t
	desc = compiegne_armistice.6.d
	picture = GFX_report_event_ott_peace_ww1
	
	trigger = {
		tag = TUR
		has_global_flag = WWI_is_now
		OR = {
			has_global_flag = WWI_GER_HAS_CAPITULATED
			NOT = { is_in_faction_with = GER }
		}
		NOT = { has_global_flag = WWI_TUR_HAS_CAPITULATED }
		NOT = { surrender_progress > 40 }
		surrender_progress > 10
		OR = {
			has_war_with = ENG
			has_war_with = FRA
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	fire_only_once = yes
	#мир
	option = {
		name = compiegne_armistice.6.a
		ENG = { country_event = compiegne_armistice.7 }
	}
	#не мир
	option = {
		trigger = {
			is_ai = no
		}
		name = compiegne_armistice.6.b
	}
}
country_event = {
	id = compiegne_armistice.7
	title = compiegne_armistice.7.t
	desc = compiegne_armistice.7.d
	picture = GFX_report_event_ott_peace_ww1
	
	is_triggered_only = yes
	
	option = {
		name = compiegne_armistice.7.a
		set_global_flag = WWI_TUR_HAS_CAPITULATED
		if = {
			limit = { TUR = { NOT = { has_war_with = RUS OR = { 230 = { OWNER = { OR = { tag = RUS tag = TUR is_subject_of = TUR } } } 899 = { OWNER = { OR = { tag = RUS tag = TUR is_subject_of = TUR } } } } } } }
			every_state = {
				limit = {
					region = 134
					is_core_of = TUR
				}
				add_core_of = KRS
				KRS = { transfer_state = PREV }
			}
		}
			every_state = {
				limit = { is_core_of = KRS is_owned_by = TUR }
				KRS = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = AZR is_owned_by = TUR }
				AZR = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = GEO is_owned_by = TUR }
				GEO = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = ARM is_owned_by = TUR }
				ARM = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = YEM is_owned_by = TUR }
				YEM = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = SAU is_owned_by = TUR }
				SAU = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = ASU is_owned_by = TUR }
				ASU = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = ASR is_owned_by = TUR }
				ASR = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = HJZ is_owned_by = TUR }
				HJZ = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = BUK is_owned_by = TUR }
				BUK = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = KHI is_owned_by = TUR }
				KHI = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = TRK is_owned_by = TUR }
				TRK = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = SIB is_owned_by = TUR }
				SIB = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_core_of = KAZ is_owned_by = TUR }
				KAZ = { transfer_state = PREV }
			}
		TUR = {
			every_state = {
				limit = { is_owned_by = TUR OR = { state = 291 state = 675 state = 676 state = 455 state = 454 state = 1155 state = 905 state = 352 } }
				ENG = { transfer_state = PREV }
			}
			every_state = {
				limit = { is_owned_by = TUR OR = { state = 553 state = 554 } }
				if = {
					limit = { FRA = { has_war_with = TUR } }
					FRA = { transfer_state = PREV }
					else = {
						ENG = { transfer_state = PREV }
					}
				}
			}
			every_country = {
				limit = {
					has_war_with = ROOT
					NOT = { original_tag = ROOT }
					#NOT = { tag = KRD }
				}
				ROOT = { white_peace = PREV }
			}
			TUR = {
				leave_faction = yes
				add_ideas = neutral_foreign_policy_law
			}
		}
		RUS = {
			if = {
				limit = { has_country_flag = RUS_occupated_PER_WWI }
				every_state = {
					limit = { is_owned_by = RUS is_core_of = PER NOT = { is_core_of = RUS } }
					PER = { transfer_state = PREV }
				}
				clr_country_flag = RUS_occupated_PER_WWI
			}
		}
	}
	option = {
		trigger = { is_ai = no }
		name = compiegne_armistice.7.b
	}
}

country_event = {
	id = compiegne_armistice.9
	title = compiegne_armistice.9.t
	desc = compiegne_armistice.9.d
	picture = GFX_report_event_germany_civil_war_soldiers
	
	hidden = yes
	
	fire_only_once = yes
	
	trigger = {
		tag = GER
		has_global_flag = WWI_is_now
		OR = {
			has_war_with = ENG
			has_war_with = FRA
		}
		OR = {
			AND = {
				has_global_flag = WWI_AUH_HAS_CAPITULATED
				has_country_flag = GER_monarchy_fall
				surrender_progress > 0.01
			}
			AND = {
				has_global_flag = WWI_AUH_HAS_CAPITULATED
				NOT = { has_country_flag = GER_monarchy_fall }
				surrender_progress > 0.1
			}
			AND = {
				NOT = { has_global_flag = WWI_AUH_HAS_CAPITULATED }
				has_country_flag = GER_monarchy_fall
				surrender_progress > 0.05
			}
			surrender_progress > 0.2
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = compiegne_armistice.9.a
		country_event = compiegne_armistice.4
	}
}

# Очередной костыль заключения мира
country_event = {
	id = compiegne_armistice.11
	hidden = yes
	trigger = {
		has_global_flag = WWI_is_now
		OR = {
			tag = GRE
			tag = GRR
		}
		OR = {
			has_war_with = GRE
			has_war_with = GRR
		}
		OR = {
			AND = {
				tag = GRE
				GRR = { has_capitulated = yes is_in_faction = yes }
			}
			AND = {
				tag = GRR
				GRE = { has_capitulated = yes is_in_faction = yes }
			}
		}
	}
	mean_time_to_happen = {
		days = 1
	}
	fire_only_once = yes
	option = {
		if = {
			limit = { tag = GRE }
			annex_country = { target = GRR transfer_troops = no }
		}
		if = {
			limit = { tag = GRR }
			annex_country = { target = GRE transfer_troops = no }
		}
	}
}

# Переговоры о мире
country_event = {
	id = compiegne_armistice.21
	title = compiegne_armistice.21.t
	desc = compiegne_armistice.21.desc
	picture = GFX_report_event_ger_november_revolution

	is_triggered_only = yes
	
	#Потребовать капитуляции
	option = {
		name = compiegne_armistice.21.a
		GER = { country_event = { id = compiegne_armistice.22 days = 3 } }
		ai_chance = {
			factor = 3
		}
	}
	
	#Потребовать отречения кайзера и капитуляции
	option = {
		trigger = {
			GER = { NOT = { has_country_flag = GER_monarchy_fall } }
		}
		name = compiegne_armistice.21.a
		GER = { country_event = { id = compiegne_armistice.23 days = 3 } }
		ai_chance = {
			factor = 1
			modifier = {
				factor = 99999
				tag = USA
			}
		}
	}
	
	#Принять предложение о мире
	option = {
		name = compiegne_armistice.21.b
		GER = { country_event = weltkrieg_frankfurt.0 }
		FRA = { country_event = weltkrieg_frankfurt.12 } # не слив
		ENG = { country_event = weltkrieg_frankfurt.14 } # не слив
		if = { limit = { TUR = { has_war_with = ENG NOT = { surrender_progress > 0.1 } } } TUR = { country_event = { id = compiegne_armistice.5 days = 1 } } } # белый мир с Османией
		else_if = { limit = { TUR = { has_war_with = ENG surrender_progress > 0.1 } } TUR = { country_event = { id = compiegne_armistice.6 days = 1 } } } # мир с Османией
		else = { TUR = { leave_faction = yes add_ideas = neutral_foreign_policy_law } } # слив Османии
		SER = { country_event = { id = weltkrieg_frankfurt.18 hours = 1 } } # не слив
		ROM = { country_event = { id = weltkrieg_frankfurt.20 hours = 1 } } # не слив
		set_global_flag = WWI_white_peace
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				FRA = { surrender_progress < 0.15 }
			}
		}
	}
}
# Требование капитуляции
country_event = {
	id = compiegne_armistice.22
	title = compiegne_armistice.22.t
	desc = compiegne_armistice.22.desc
	picture = GFX_report_event_ger_november_revolution

	is_triggered_only = yes
	
	#Это неприемлимо
	option = {
		name = compiegne_armistice.22.a
		set_country_flag = GER_peace_negotiations_with_Entente
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				has_country_flag = GER_monarchy_fall
			}
		}
	}
	
	#Мы согласны
	option = {
		name = compiegne_armistice.22.b
		country_event = { id = compiegne_armistice.4 days = 1 }
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				NOT = { has_country_flag = GER_monarchy_fall }
			}
		}
	}
}
# Требование отречения кайзера и капитуляции
country_event = {
	id = compiegne_armistice.23
	title = compiegne_armistice.23.t
	desc = compiegne_armistice.23.desc
	picture = GFX_report_event_ger_november_revolution

	is_triggered_only = yes
	
	#Это неприемлимо
	option = {
		name = compiegne_armistice.23.a
		set_country_flag = GER_peace_negotiations_with_Entente
		ai_chance = {
			factor = 3
			modifier = {
				factor = 0.5
				GER = { surrender_progress > 0.02 }
			}
			modifier = {
				factor = 0.5
				GER = { surrender_progress > 0.03 }
			}
			modifier = {
				factor = 0
				GER = { surrender_progress > 0.04 }
			}
		}
	}
	
	#Мы согласны
	option = {
		name = compiegne_armistice.23.b
		country_event = { id = germany.141 days = 1 }
		country_event = { id = compiegne_armistice.4 days = 3 }
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				GER = { surrender_progress < 0.01 }
			}
		}
	}
}
# Требование отречения кайзера и капитуляции
country_event = {
	id = compiegne_armistice.24
	title = compiegne_armistice.24.t
	desc = compiegne_armistice.24.desc
	picture = GFX_report_event_ger_november_revolution

	trigger = {
		GER = { has_country_flag = GER_peace_negotiations_with_Entente }
		GER = { has_war_with = ENG }
		OR = {
			AND = {
				tag = USA
				has_war_with = GER
			}
			AND = {
				tag  = ENG
				USA = { NOT = { has_war_with = GER } }
			}
		}
	}
	
	mean_time_to_happen = {
		days = 15
	}
	
	#Потребовать капитуляции и отречения кайзера
	option = {
		trigger = {
			GER = { NOT = { has_country_flag = GER_monarchy_fall } }
		}
		name = compiegne_armistice.24.a
		GER = { country_event = { id = compiegne_armistice.25 days = 3 } }
		ai_chance = {
			factor = 1
		}
	}
	
	#Свернуть переговоры
	option = {
		name = compiegne_armistice.24.b
		GER = { country_event = { id = compiegne_armistice.26 days = 0 } }
		ai_chance = {
			factor = 0
		}
	}
}
# Требование отречения кайзера и капитуляции
country_event = {
	id = compiegne_armistice.25
	title = compiegne_armistice.25.t
	desc = compiegne_armistice.25.desc
	picture = GFX_report_event_ger_november_revolution

	is_triggered_only = yes
	
	#Это неприемлимо
	option = {
		name = compiegne_armistice.25.a
		clr_country_flag = GER_peace_negotiations_with_Entente
		add_popularity = {
			ideology = authoritarism
			popularity = -0.05
		}
		ai_chance = {
			factor = 5
		}
	}
	
	#Мы согласны
	option = {
		name = compiegne_armistice.25.b
		country_event = { id = germany.141 days = 1 }
		country_event = { id = compiegne_armistice.4 days = 3 }
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
	}
}
# Сворачивание переговоров
country_event = {
	id = compiegne_armistice.26
	title = compiegne_armistice.26.t
	desc = compiegne_armistice.26.desc
	picture = GFX_report_event_ger_november_revolution

	is_triggered_only = yes
	
	option = {
		name = compiegne_armistice.26.a
		clr_country_flag = GER_peace_negotiations_with_Entente
		add_popularity = {
			ideology = authoritarism
			popularity = -0.05
		}
	}
}

# Австро-Венгрия
country_event = {
	id = compiegne_armistice.998
	title = compiegne_armistice.3.t
	desc = compiegne_armistice.3.d
	picture = GFX_report_event_auh_peace_ww1
	
	fire_only_once = yes
	
	immediate = {
		every_country = {
			limit = { OR = { is_subject = no tag = AST tag = SAF tag = CAN tag = NZL } NOT = { has_country_flag = WWI_Entente_member } has_war_with = AUH OR = { is_in_faction_with = ENG is_in_faction_with = FRA } NOT = { is_in_faction_with = GER } NOT = { tag = BUL tag = TUR tag = GER tag = AUH } }
			set_country_flag = WWI_Entente_member
		}
		every_country = {
			limit = { has_country_flag = WWI_Entente_member OR = { NOT = { is_in_faction_with = ENG is_in_faction_with = FRA } is_in_faction_with = GER is_in_faction_with = AUH } }
			clr_country_flag = WWI_Entente_member
		}
		every_country = {
			limit = { NOT = { has_country_flag = WWI_Central_Powers_member } has_war_with = ENG OR = { is_in_faction_with = GER is_in_faction_with = AUH is_in_faction_with = BUL is_in_faction_with = TUR } NOT = { tag = ENG tag = FRA tag = ITA tag = RUS } }
			set_country_flag = WWI_Central_Powers_member
		}
		every_country = {
			limit = { has_country_flag = WWI_Central_Powers_member OR = { is_in_faction_with = ENG has_war_with = GER has_war_with = AUH NOT = { has_war_with = ENG } } }
			clr_country_flag = WWI_Central_Powers_member
		}
		if = {
			limit = { RUS = { has_country_flag = WWI_Entente_member has_country_flag = RUS_monarchy_not_fall has_variable = RUS_otrecheniye } }
			RUS = { add_to_variable = { RUS_otrecheniye = -2 } }
		}
	}
	
	is_triggered_only = yes

	fire_only_once = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = compiegne_armistice.3.a
		set_global_flag = WWI_AUH_HAS_CAPITULATED
		leave_faction = yes
		add_ideas = neutral_foreign_policy_law
		ALB = {
			if = {
				limit = {
					any_country = {
						NOT = { tag = ALB }
						controls_state = 44
						is_socialist_country = yes
					}
				}
				set_politics = {
					ruling_party = communism
				}
				add_popularity = {
					ideology = communism
					popularity = 0.2
				}
			}
		}
		CZE = {
			if = {
				limit = {
					any_country = {
						NOT = { tag = CZE }
						OR = { controls_state = 9 controls_state = 75 }
						is_socialist_country = yes
					}
				}
				set_politics = {
					ruling_party = communism
				}
				add_popularity = {
					ideology = communism
					popularity = 0.2
				}
			}
		}
		HUN = {
			if = {
				limit = {
					any_country = {
						NOT = { tag = HUN }
						OR = { controls_state = 43 controls_state = 154 controls_state = 155 }
						is_socialist_country = yes
					}
				}
				set_politics = {
					ruling_party = communism
				}
				add_popularity = {
					ideology = communism
					popularity = 0.2
				}
			}
		}
		SLO = {
			if = {
				limit = {
					any_country = {
						NOT = {
							tag = SLO
							tag = CZE
							tag = HUN
						}
						controls_state = 70
						is_socialist_country = yes
					}
				}
				set_politics = {
					ruling_party = communism
				}
				add_popularity = {
					ideology = communism
					popularity = 0.2
				}
			}
		}
		if = {
			limit = {
				any_country = {
					NOT = {
						tag = AUH
						tag = AUS
					}
					OR = { controls_state = 4 controls_state = 1363 controls_state = 152 }
					is_socialist_country = yes
				}
			}
			add_stability = -1
			add_popularity = {
				ideology = communism
				popularity = 0.3
			}
			add_popularity = {
				ideology = radical_socialism
				popularity = 0.1
			}
			add_popularity = {
				ideology = social_democracy
				popularity = 0.15
			}
			add_popularity = {
				ideology = market_liberalism
				popularity = 0.1
			}
			else = {
				add_stability = -0.25
				add_popularity = {
					ideology = authoritarism
					popularity = -0.5
				}
				add_popularity = {
					ideology = market_liberalism
					popularity = 0.1
				}
				add_popularity = {
					ideology = social_democracy
					popularity = 0.2
				}
			}
		}
		random_country = {
			limit = { owns_state = 984 }
			set_state_owner = 1105
		}
		ALB = {
			set_state_owner = 44
			set_state_owner = 805
			set_state_owner = 1360
		}
		AUH = {
			every_owned_state = {
				limit = { OR = { state = 107 state = 108 state = 948 state = 947 state = 803 state = 1263 state = 802 state = 928 state = 106 state = 993 state = 986 state = 105 state = 1265 } }
				SER = { transfer_state = PREV }
			}
		}
		SER = {
			if = {
				limit = {
					any_country = {
						NOT = { tag = SER }
						OR = { controls_state = 107 controls_state = 108 controls_state = 948 }
						is_socialist_country = yes
					}
				}
				set_politics = {
					ruling_party = communism
				}
				add_popularity = {
					ideology = communism
					popularity = 0.2
				}
			}
			release_puppet = MNT
		}
		if = {
			limit = { ROM = { owns_state = 79 } 78 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 78 }
		}
		if = {
			limit = { ROM = { owns_state = 79 } 766 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 766 }
		}
		if = {
			limit = { ROM = { owns_state = 79 } 1294 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 1294 }
		}
		if = {
			limit = { ROM = { owns_state = 79 } 1307 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 1307 }
		}
		if = {
			limit = { ROM = { owns_state = 79 } 80 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 80 }
		}
		if = {
			limit = { ROM = { owns_state = 79 } 1212 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 1212 }
		}
		if = {
			limit = { ROM = { owns_state = 79 } 972 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 972 }
		}
		if = {
			limit = { ROM = { owns_state = 46 } 1047 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 1047 }
		}
		if = {
			limit = { ROM = { owns_state = 46 } 1046 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 1046 }
		}
		if = {
			limit = { ROM = { owns_state = 81 } 1264 = { OWNER = { OR = { tag = AUS tag = AUH tag = HUN } } } }
			ROM = { transfer_state = 1264 }
		}
		if = {
			limit = { ROM = { controls_state = 76 } }
			ROM = { transfer_state = 76 }
		}
		if = {
			limit = { ROM = { controls_state = 84 } }
			ROM = { transfer_state = 84 }
		}
		if = {
			limit = { ROM = { controls_state = 83 OR = { owns_state = 76 owns_state = 84 } } }
			ROM = { transfer_state = 83 transfer_state = 84 }
		}
		if = {
			limit = { ROM = { controls_state = 154 OR = { owns_state = 76 owns_state = 82 owns_state = 83 } } }
			ROM = { transfer_state = 154 transfer_state = 82 transfer_state = 83 }
		}
		if = {
			limit = { ROM = { NOT = { has_war_with = BUL } } }
			ROM = { leave_faction = yes }
			if = {
				limit = { GER = { is_faction_leader = yes } }
				every_country = {
					limit = { OR = { is_in_faction_with = GER is_in_faction_with = AUH is_in_faction_with = TUR AND = { is_in_faction_with = BUL NOT = { is_in_faction_with = ENG } } } }
					white_peace = ROM
				}
				else = { AUH = { white_peace = ROM } }
			}
		}
		CRO = {
			if = {
				limit = {
					any_country = {
						NOT = { tag = CRO }
						is_socialist_country = yes
						OR = { controls_state = 109 controls_state = 104 }
					}
				}
				set_politics = {
					ruling_party = communism
				}
				add_popularity = {
					ideology = communism
					popularity = 0.2
				}
			}
			set_cosmetic_tag = SCS
		}
		AUH = {
			every_owned_state = {
				limit = {
					OR = {
						state = 158
						state = 159
						state = 160
						state = 161
						state = 1032
						state = 1031
						state = 1033
						
						state = 850
						state = 1043
						state = 39
					}
				}
				ITA = { transfer_state = PREV }
			}
		}
		if = {
			limit = { ITA = { controls_state = 103 } }
			ITA = { set_state_owner = 103 }
		}
		else_if = {
			limit = { SER = { controls_state = 103 } }
			SER = { set_state_owner = 103 }
		}
		else = {
			CRO = { transfer_state = 103 }
		}
		if = {
			limit = { ITA = { controls_state = 968 owns_state = 103 } }
			ITA = { set_state_owner = 968 }
		}
		else_if = {
			limit = { SER = { controls_state = 968 owns_state = 104 } }
			SER = { set_state_owner = 968 }
		}
		else = {
			CRO = { transfer_state = 968 }
		}
		if = {
			limit = { ITA = { controls_state = 163 } }
			ITA = { set_state_owner = 163 }
		}
		else_if = {
			limit = { SER = { controls_state = 163 owns_state = 103 } }
			SER = { set_state_owner = 163 }
		}
		else = {
			CRO = { transfer_state = 163 }
		}
		if = {
			limit = { SER = { controls_state = 963 } }
			SER = { set_state_owner = 963 }
			else = { CRO = { transfer_state = 963 } }
		}
		if = {
			limit = { SER = { controls_state = 804 } }
			SER = { set_state_owner = 804 }
			else = { CRO = { transfer_state = 804 } }
		}
		if = {
			limit = { SER = { controls_state = 104 } }
			SER = { set_state_owner = 104 }
			else = { CRO = { transfer_state = 104 } }
		}
		if = {
			limit = { SER = { controls_state = 1374 } }
			SER = { set_state_owner = 1374 }
			else = { CRO = { transfer_state = 1374 } }
		}
		if = {
			limit = { SER = { OR = { controls_state = 45 OR = { owns_state = 1374 owns_state = 963 } } } }
			SER = { set_state_owner = 45 }
		}
		else_if = {
			limit = { AUH = { NOT = { controls_state = 45 } } }
			CRO = { transfer_state = 45 }
		}
		if = {
			limit = { SER = { OR = { owns_state = 45 owns_state = 963 } } }
			SER = { set_state_owner = 962 }
		}
		else_if = {
			limit = { AUH = { NOT = { controls_state = 962 } } }
			CRO = { transfer_state = 962 }
		}
		if = {
			limit = { ITA = { controls_state = 967 } }
			ITA = { set_state_owner = 967 }
			else = { CRO = { transfer_state = 967 } }
		}
		if = {
			limit = { ITA = { controls_state = 853 owns_state = 967 } }
			ITA = { set_state_owner = 853 }
			else = { CRO = { transfer_state = 853 } }
		}
		if = {
			limit = { ITA = { controls_state = 102 owns_state = 967 } }
			ITA = { set_state_owner = 102 }
			else = { CRO = { transfer_state = 102 } }
		}
		if = {
			limit = { ITA = { controls_state = 852 owns_state = 736 } }
			ITA = { set_state_owner = 852 }
		}
		if = {
			limit = { ITA = { controls_state = 966 owns_state = 852 } }
			ITA = { set_state_owner = 966 }
		}
		if = {
			limit = { ITA = { controls_state = 1267 OR = { owns_state = 103 owns_state = 966 } } }
			ITA = { set_state_owner = 1267 }
		}
		else_if = {
			limit = { SER = { controls_state = 1267 OR = { owns_state = 103 owns_state = 104 } } }
			SER = { set_state_owner = 1267 }
		}
		else = {
			CRO = { transfer_state = 1267 }
		}
		if = {
			limit = { SER = { controls_state = 966 owns_state = 1267 } }
			SER = { set_state_owner = 966 }
		}
		if = {
			limit = { ITA = { OR = { controls_state = 736 owns_state = 853 owns_state = 1267 } } }
			ITA = { set_state_owner = 736 }
		}
		else_if = {
			limit = { SER = { owns_state = 853 owns_state = 1267 } }
			SER = { set_state_owner = 736 }
		}
		else = {
			CRO = { transfer_state = 736 }
		}
		if = {
			limit = { ITA = { controls_state = 852 owns_state = 736 } }
			ITA = { set_state_owner = 852 }
		}
		else_if = {
			limit = { SER = { owns_state = 966 } }
			SER = { set_state_owner = 852 }
		}
		else = {
			CRO = { transfer_state = 852 }
		}
		if = {
			limit = { ITA = { controls_state = 966 owns_state = 852 } }
			ITA = { set_state_owner = 966 }
			else = {
				CRO = { transfer_state = 966 }
			}
		}
		if = {
			limit = { ITA = { OR = { owns_state = 967 owns_state = 102 } } }
			ITA = { set_state_owner = 1358 }
			else = { CRO = { transfer_state = 1358 } }
		}
		
		if = {
			limit = { CRO = { OR = { owns_state = 102 owns_state = 853 owns_state = 1267 owns_state = 104 owns_state = 963 } } }
			CRO = { transfer_state = 109 }
			else = { SER = { set_state_owner = 109 } }
		}
		
		if = {
			limit = { controls_state = 10 }
			POL = { set_state_owner = 10 set_state_owner = 87 set_state_owner = 98 set_state_owner = 90 set_state_owner = 1115 set_state_owner = 1117 set_state_owner = 1118 set_state_owner = 1120 }
		}
		every_state = {
			limit = {
				is_controlled_by = ROOT
				OR = {
					region = 38
					state = 92
					state = 904
					state = 1165
				}
			}
			POL = { transfer_state = PREV }
		}
		if = {
			limit = { POL = { owns_state = 10 OR = { owns_state = 87 owns_state = 90 } NOT = { owns_state = 1166 } } }
			POL = { transfer_state = 1166 }
		}
		if = {
			limit = { RUS = { controls_state = 88 } }
			RUS = { set_state_owner = 88 }
		}
		if = {
			limit = { RUS = { controls_state = 91 } }
			RUS = {
				set_state_owner = 89
				set_state_owner = 91
				set_state_owner = 925
			}
		}
		else_if ={
			limit = { UKR = { controls_state = 91 } }
			UKR = {
				set_state_owner = 89
				set_state_owner = 91
				set_state_owner = 925
			}
		}
		else = {
			GAL = {
				set_state_owner = 89
				set_state_owner = 91
				set_state_owner = 925
			}
		}
		
		
		if = {
			limit = { NOT = { has_global_flag = WWI_GER_HAS_CAPITULATED } }
			if = {
				limit = { controls_state = 848 }
				GER = { transfer_state = 848 }
				else = {
					every_country = {
						limit = { controls_state = 848 }
						transfer_state = 848
						GER = { transfer_state = 848 }
					}
				}
			}
			if = {
				limit = { GER = { has_war_with = ITA } }
				if = {
					limit = { controls_state = 153 }
					GER = { transfer_state = 153 }
					else = {
						every_country = {
							limit = { controls_state = 153 }
							transfer_state = 153
							GER = { transfer_state = 153 }
						}
					}
				}
			}
			every_state = {
				limit = {
					is_controlled_by = ROOT
					OR = {
						state = 98
						state = 1118
						state = 1120
						state = 97
						state = 1001
						state = 1119
						state = 87
						state = 1115
						state = 10
						state = 1116
						state = 90
						state = 1117
						state = 92
						state = 904
						state = 1165
						state = 93
						state = 204
						state = 194
						state = 994
						state = 922
					}
				}
				GER = { set_state_controller = PREV }
			}
		}
		
		if = {
			limit = { ROM = { controls_state = 73 } }
			ROM = { set_state_owner = 73 }
		}
		else_if = {
			limit = { OR = { UKR = { controls_state = 73 } AND = { UKR = { exists = yes is_subject_of = RUS } RUS = { controls_state = 73 } } } }
			UKR = { set_state_owner = 73 }
		}
		else_if = {
			limit = { RUS = { controls_state = 73 } }
			RUS = { set_state_owner = 73 }
		}
		if = {
			limit = {
				OR = {
					ROM = { controls_state = 80 }
					GAL = { exists = no }
				}
			}
			ROM = { set_state_owner = 80 }
			else = { GAL = { set_state_owner = 80 } }
		}
			add_ideas = neutral_foreign_policy_law
			every_country = {
				limit = {
					has_war_with = ROOT
					NOT = { original_tag = ROOT }
					NOT = { tag = AUS }
					NOT = { tag = HUN }
					NOT = { tag = AUH }
					NOT = { tag = CZE }
					NOT = { tag = SLO }
				}
				ROOT = { white_peace = PREV }
			}
		every_country = {
			limit = { is_subject_of = ROOT }
			hidden_effect = { country_event = { id = compiegne_armistice.0 hours = 1 } }
		}
		every_country = {
			limit = { OR = { tag = ENG tag = FRA tag = ITA tag = GRR tag = GRE tag = RUS } OR = { is_in_faction_with = ENG AND = { is_in_faction_with = FRA NOT = { is_in_faction_with = GER } } } }
			PREV = { give_military_access = PREV }
		}
		hidden_effect = {
			country_event = { id = compiegne_armistice.-1 hours = 1 }
		}
		hidden_effect = { news_event = { id = news_n.103 hours = 3 } }
		add_ideas = disarmed_nation
		if = {
			limit = { NOT = { has_idea = undisturbed_isolation has_idea = isolation } }
			add_ideas = civilian_economy
		}
		add_threat = -15
		BUL = {
			if = {
				limit = { has_idea = BUL_dependent_bulgarian_economy }
				remove_ideas = BUL_dependent_bulgarian_economy
			}
		}
		GER = {
			if = {
				limit = { has_idea = GER_dependent_bulgarian_economy }
				remove_ideas = GER_dependent_bulgarian_economy
			}
		}
		AUH = {
			every_owned_state = {
				limit = { OR = { is_core_of = FRA } }
				FRA = { transfer_state = PREV }
			}
			every_owned_state = {
				limit = { OR = { is_core_of = SER } }
				SER = { transfer_state = PREV }
			}
			every_owned_state = {
				limit = { OR = { is_core_of = ITA } }
				ITA = { transfer_state = PREV }
			}
			every_owned_state = {
				limit = { OR = { is_core_of = ALB } }
				ALB = { transfer_state = PREV }
			}
		}
	}
	option = {
		trigger = {
			is_ai = no
		}
		name = compiegne_armistice.3.b
	}
}

# Болгария
country_event = {
	id = compiegne_armistice.999
	title = compiegne_armistice.2.t
	desc = compiegne_armistice.2.d
	picture = GFX_report_event_bul_peace_ww1
	
	immediate = {
		every_country = {
			limit = { OR = { is_subject = no tag = AST tag = SAF tag = CAN tag = NZL } NOT = { has_country_flag = WWI_Entente_member } has_war_with = BUL OR = { is_in_faction_with = ENG is_in_faction_with = FRA } NOT = { is_in_faction_with = GER } NOT = { tag = BUL tag = TUR tag = GER tag = AUH } }
			set_country_flag = WWI_Entente_member
		}
		every_country = {
			limit = { has_country_flag = WWI_Entente_member OR = { NOT = { is_in_faction_with = ENG is_in_faction_with = FRA } is_in_faction_with = GER is_in_faction_with = AUH } }
			clr_country_flag = WWI_Entente_member
		}
		every_country = {
			limit = { NOT = { has_country_flag = WWI_Central_Powers_member } has_war_with = ENG OR = { is_in_faction_with = GER is_in_faction_with = AUH is_in_faction_with = BUL is_in_faction_with = TUR } NOT = { tag = ENG tag = FRA tag = ITA tag = RUS } }
			set_country_flag = WWI_Central_Powers_member
		}
		every_country = {
			limit = { has_country_flag = WWI_Central_Powers_member OR = { is_in_faction_with = ENG has_war_with = GER has_war_with = AUH NOT = { has_war_with = ENG } } }
			clr_country_flag = WWI_Central_Powers_member
		}
		if = {
			limit = { RUS = { has_country_flag = WWI_Entente_member has_country_flag = RUS_monarchy_not_fall has_variable = RUS_otrecheniye } }
			RUS = { add_to_variable = { RUS_otrecheniye = -1 } }
		}
	}
	
	is_triggered_only = yes
	
	option = {
		name = compiegne_armistice.2.a
		GER = { clr_country_flag = GER_keep_BUL clr_country_flag = flag_GER_BUL_recrute_BUL_generals clr_country_flag = flag_GER_BUL_unite_progerman_opposition }
		set_global_flag = WWI_BUL_HAS_CAPITULATED
		add_ideas = BUL_interunion_commission_idea
		add_ideas = BUL_prisoners_of_war_in_SER_BUL
		SER = { add_ideas = BUL_prisoners_of_war_in_SER_SER }
		if = {
			limit = { has_completed_focus = BUL_desperate_struggle }
			unlock_national_focus = BUL_quest_for_peace
		}
		BUL = {
			clr_country_flag = BUL_claim_on_ALB_1
			clr_country_flag = BUL_claim_on_ALB_2
			clr_country_flag = BUL_claim_on_ALB_3
		}
		hidden_effect = {
			every_state = {
				limit = {
					OR = {
						region = 130
						region = 239
						region = 240
						region = 133
						region = 131
						state = 93
					}
					is_core_of = UKR
					is_owned_by = AUH
				}
				UKR = { transfer_state = PREV }
			}
			every_state = {
				limit = {
					OR = {
						region = 130
						region = 239
						region = 240
						region = 133
						region = 131
						state = 93
					}
					is_core_of = USR
					is_owned_by = AUH
				}
				USR = { transfer_state = PREV }
			}
			if = {
				limit = { owns_state = 240 }
				221 = { OWNER = { transfer_state = 240 } }
			}
			if = {
				limit = { country_exists = CRI }
				every_state = {
					limit = {
						is_owned_by = ROOT
						region = 230
						NOT = { is_core_of = ROOT }
					}
					CRI = { transfer_state = PREV }
				}
				else = {
					random_other_country = {
						limit = { any_owned_state = { region = 230 } }
						every_state = {
							limit = {
								is_owned_by = ROOT
								region = 230
								NOT = { is_core_of = ROOT }
							}
							PREV = { transfer_state = PREV }
						}
					}
				}
			}
		}
		every_state = {
			limit = {
				OR = {
					region = 133
					region = 135
					region = 137
				}
				is_core_of = RUS
				is_owned_by = AUH
			}
			RUS = { transfer_state = PREV }
		}
		BUL = {
			if = {
				limit = {
					any_country = {
						NOT = { tag = BUL }
						is_socialist_country = yes
						count_triggers = { amount = 2 controls_state = 48 controls_state = 987 controls_state = 211 controls_state = 212 controls_state = 945 controls_state = 944 }
					}
				}
				set_country_flag = communist_occ
			}
			every_state = {
				limit = { is_owned_by = PREV region = 25 }
				ENG = { transfer_state = PREV }
			}
			if = {
				limit = { ROM = { NOT = { has_war_with = AUH } } }
				ROM = { leave_faction = yes }
				if = {
					limit = { GER = { is_faction_leader = yes } }
					every_country = {
						limit = { OR = { is_in_faction_with = GER is_in_faction_with = AUH is_in_faction_with = TUR AND = { is_in_faction_with = BUL NOT = { is_in_faction_with = ENG } } } }
						white_peace = ROM
					}
					else = { BUL = { white_peace = ROM } }
				}
			}
			leave_faction = yes
			add_ideas = neutral_foreign_policy_law
			every_country = {
				limit = {
					has_war_with = ROOT
					NOT = { original_tag = ROOT }
				}
				ROOT = { white_peace = PREV }
			}
			every_country = {
				limit = { is_subject_of = ROOT }
				hidden_effect = { country_event = { id = compiegne_armistice.0 hours = 1 } }
			}
			every_country = {
				limit = { OR = { tag = ENG tag = FRA tag = ITA tag = GRR tag = GRE tag = RUS } OR = { is_in_faction_with = ENG AND = { is_in_faction_with = FRA NOT = { is_in_faction_with = GER } } } }
				PREV = { give_military_access = PREV }
			}
			hidden_effect = {
				if = {
					limit = { OR = { has_country_flag = communist_occ has_government = communism } }
					
					clr_country_flag = communist_occ
					if = {
						limit = { NOT = { has_government = communism } }
						set_politics = {
							ruling_party = communism
						}
						add_popularity = {
							ideology = authoritarism
							popularity = -1
						}
						add_popularity = {
							ideology = market_liberalism
							popularity = -0.5
						}
						add_popularity = {
							ideology = communism
							popularity = 0.2
						}
					}
				}
			}
		}
		every_state = {
			limit = { OR = { is_core_of = BUL is_claimed_by = BUL } NOT = { is_owned_by = BUL } }
			remove_claim_by = BUL
			remove_core_of = BUL
		}
		add_threat = -5
		if = {
				limit = { has_idea = BUL_dependent_bulgarian_economy }
				remove_ideas = BUL_dependent_bulgarian_economy
			}
		GER = {
			if = {
				limit = { has_idea = GER_dependent_bulgarian_economy }
				remove_ideas = GER_dependent_bulgarian_economy
			}
		}
	}
}