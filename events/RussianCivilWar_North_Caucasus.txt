###########################
# Russian Civil War Events
###########################

add_namespace = rcw_nc

# Отделение горской республики
country_event = {
	id = rcw_nc.1
	title = rcw_nc.1.t
	desc = rcw_nc.1.desc
	picture = GFX_report_event_sov_redarmy
	
	trigger = {
		has_start_date < 1917.11.7
		NOT = { has_global_flag = RUS_civil_war_over }
		tag = RUS
		OR = {
			MRC = { exists = no }
			MRC = { is_subject_of = ROOT }
		}
		has_country_flag = RUS_Oktober_revolution_fired
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	fire_only_once = yes
	
	option = {
		name = rcw_nc.1.a
		every_state = {
			limit = {
				OR = {
					is_core_of = DAG
					is_core_of = CHC
					is_core_of = OSE
					is_core_of = CBR
					is_core_of = BLK
				}
			}
			add_core_of = MRC
		}
		every_state = {
			limit = {
				OR = {
					state = 821
					state = 1232
					state = 1278
					state = 827
					state = 828
					state = 921
				}
				is_owned_by = RUS
			}
			MRC = { transfer_state = PREV }
		}
		MRC = {
			add_ideas = neutral_foreign_policy_law
			hidden_effect = {
				every_country = {
					limit = {
						NOT = {
							tag = PREV
							is_any_former_russian_empire_country = yes
							former_russian_empire_baltic_states_country = yes
							has_war_with = PREV
							is_in_faction_with = PREV
						}
					}
					set_THIS_country_non_recognize_PREV = yes
				}
			}
			country_event = { id = rcw_nc.2 days = 33 }
			load_oob = MRC_1917
		}
	}
	option = {
		trigger = {
			is_ai = no
		}
		name = rcw_nc.1.b
		every_state = {
			limit = {
				OR = {
					is_core_of = DAG
					is_core_of = CHC
					is_core_of = OSE
					is_core_of = CBR
					is_core_of = BLK
				}
			}
			add_core_of = MRC
		}
		every_state = {
			limit = {
				OR = {
					state = 821
					state = 1232
					state = 1278
					state = 827
					state = 828
					state = 921
				}
				is_owned_by = RUS
			}
			MRC = { transfer_state = PREV }
		}
		MRC = {
			add_ideas = neutral_foreign_policy_law
			hidden_effect = {
				every_country = {
					limit = {
						NOT = {
							tag = PREV
							is_any_former_russian_empire_country = yes
							former_russian_empire_baltic_states_country = yes
							has_war_with = PREV
							is_in_faction_with = PREV
						}
					}
					set_THIS_country_non_recognize_PREV = yes
				}
			}
			country_event = { id = rcw_nc.2 days = 33 }
			load_oob = MRC_1917
		}
		MRC = { change_tag_from = ROOT }
	}
}

# Комиссар-атаман (прибытие Караулова)
country_event = {
	id = rcw_nc.2
	title = rcw_nc.2.t
	desc = rcw_nc.2.desc
	picture = GFX_report_event_sov_redarmy
	
	is_triggered_only = yes
	
	option = {
		name = rcw_nc.2.a
		if = {
			limit = { owns_state = 232 }
			set_capital = { state = 232 }
			else = {
				set_capital = { state = 821 }
			}
		}
		every_owned_state = {
			limit = {
				OR = {
					is_core_of = TCH
					is_core_of = CBR
					is_core_of = BLK
				}
			}
			TCH = { transfer_state = PREV }
		}
		TCH = {
			set_capital = { state = 828 }
			add_ideas = neutral_foreign_policy_law
			add_ideas = TCH_vladikavkazian_soviet
			add_ideas = TCH_dvoevlastie
			add_ideas = TCH_soldiers_from_Caucasian_front
			hidden_effect = {
				division_template = {
					name = "Kazachyya brigada"
					regiments = {
						irregular_cavalry = { x = 0 y = 0 }
						irregular_cavalry = { x = 0 y = 1 }
						irregular_cavalry = { x = 0 y = 2 }
					}
				}
			}
			capital_scope = {
				create_unit = {
					division = "name = \"Kazachyya brigada\" division_template = \"Kazachyya brigada\" start_experience_factor = 0.1 start_equipment_factor = 1"
					owner = TCH
				}
				create_unit = {
					division = "name = \"Kazachyya brigada\" division_template = \"Kazachyya brigada\" start_experience_factor = 0.1 start_equipment_factor = 1"
					owner = TCH
				}
				create_unit = {
					division = "name = \"Kazachyya brigada\" division_template = \"Kazachyya brigada\" start_experience_factor = 0.1 start_equipment_factor = 1"
					owner = TCH
				}
			}
			hidden_effect = {
				every_country = {
					limit = {
						NOT = {
							tag = PREV
							is_any_former_russian_empire_country = yes
							former_russian_empire_baltic_states_country = yes
							has_war_with = PREV
							is_in_faction_with = PREV
						}
					}
					set_THIS_country_non_recognize_PREV = yes
				}
			}
		}
	}
	option = {
		trigger = {
			is_ai = no
		}
		name = rcw_nc.2.b
		if = {
			limit = { owns_state = 232 }
			set_capital = { state = 232 }
			else = {
				set_capital = { state = 821 }
			}
		}
		every_owned_state = {
			limit = {
				OR = {
					is_core_of = TCH
					is_core_of = CBR
					is_core_of = BLK
				}
			}
			TCH = { transfer_state = PREV }
		}
		TCH = {
			set_capital = { state = 828 }
			add_ideas = neutral_foreign_policy_law
			add_ideas = TCH_vladikavkazian_soviet
			add_ideas = TCH_dvoevlastie
			add_ideas = TCH_soldiers_from_Caucasian_front
			hidden_effect = {
				division_template = {
					name = "Kazachyya brigada"
					regiments = {
						irregular_cavalry = { x = 0 y = 0 }
						irregular_cavalry = { x = 0 y = 1 }
						irregular_cavalry = { x = 0 y = 2 }
					}
				}
			}
			capital_scope = {
				create_unit = {
					division = "name = \"Kazachyya brigada\" division_template = \"Kazachyya brigada\" start_experience_factor = 0.1 start_equipment_factor = 1"
					owner = TCH
				}
				create_unit = {
					division = "name = \"Kazachyya brigada\" division_template = \"Kazachyya brigada\" start_experience_factor = 0.1 start_equipment_factor = 1"
					owner = TCH
				}
				create_unit = {
					division = "name = \"Kazachyya brigada\" division_template = \"Kazachyya brigada\" start_experience_factor = 0.1 start_equipment_factor = 1"
					owner = TCH
				}
				create_unit = {
					division = "name = \"Kazachyya brigada\" division_template = \"Kazachyya brigada\" start_experience_factor = 0.1 start_equipment_factor = 1"
					owner = TCH
				}
				create_unit = {
					division = "name = \"Kazachyya brigada\" division_template = \"Kazachyya brigada\" start_experience_factor = 0.1 start_equipment_factor = 1"
					owner = TCH
				}
			}
			hidden_effect = {
				every_country = {
					limit = {
						NOT = {
							tag = PREV
							is_any_former_russian_empire_country = yes
							former_russian_empire_baltic_states_country = yes
							has_war_with = PREV
							is_in_faction_with = PREV
						}
					}
					set_THIS_country_non_recognize_PREV = yes
				}
			}
		}
		TCH = { change_tag_from = ROOT }
	}
}

# Военное положение
country_event = {
	id = rcw_nc.3
	title = rcw_nc.3.t
	desc = rcw_nc.3.desc
	picture = GFX_report_event_sov_redarmy
	
	is_triggered_only = yes
	
	option = {
		name = rcw_nc.3.a
	}
}

# Победа в битве за Грозный
country_event = {
	id = rcw_nc.4
	title = rcw_nc.4.t
	desc = {
		text = rcw_nc.4.desc
		trigger = { tag = MRC }
	}
	desc = {
		text = rcw_nc.4.desc_1
		trigger = { tag = RSR }
	}
	picture = GFX_report_event_sov_redarmy
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			tag = MRC
		}
		name = rcw_nc.4.a
		transfer_state = 232
	}
	option = {
		trigger = {
			tag = RSR
		}
		name = rcw_nc.4.b
	}
}
# Поражение в битве за Грозный
country_event = {
	id = rcw_nc.5
	title = rcw_nc.5.t
	desc = {
		text = rcw_nc.5.desc
		trigger = { tag = MRC }
	}
	desc = {
		text = rcw_nc.5.desc_1
		trigger = { tag = RSR }
	}
	picture = GFX_report_event_sov_redarmy
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			tag = MRC
		}
		name = rcw_nc.5.a
	}
	option = {
		trigger = {
			tag = RSR
		}
		name = rcw_nc.5.b
	}
}
# Народы гор
country_event = {
	id = rcw_nc.6
	title = rcw_nc.6.t
	desc = rcw_nc.6.desc
	picture = GFX_report_event_sov_redarmy
	
	is_triggered_only = yes
	
	option = {
		name = rcw_nc.6.a
		add_ideas = TCH_unpunished_bandit_raids
	}
}
# Прибытие Фронтовиков
country_event = {
	id = rcw_nc.7
	title = rcw_nc.7.t
	desc = {
		text = rcw_nc.7.desc
		trigger = { has_country_flag = TCH_karaulov_will_die }
	}
	desc = {
		text = rcw_nc.7.desc_1
		trigger = { NOT = { has_country_flag = TCH_karaulov_will_die } }
	}
	picture = GFX_report_event_sov_redarmy
	
	is_triggered_only = yes
	
	fire_only_once = yes
	
	option = {
		trigger = {
			has_country_flag = TCH_karaulov_will_die
		}
		name = rcw_nc.7.a
		hidden_effect = {
			division_template = {
				name = "Kazachiy polk"
				regiments = {
					cavalry = { x = 0 y = 0 }
					cavalry = { x = 0 y = 1 }
					cavalry = { x = 0 y = 2 }
				}
			}
		}
		capital_scope = {
			create_unit = {
				division = "name = \"1-y Volgskiy polk Terskogo kazachyego voyska\" division_template = \"Kazachiy polk\" start_experience_factor = 0.1 start_equipment_factor = 1"
				owner = ROOT
			}
		}
		custom_effect_tooltip = rcw_nc_7_tt
		
		clr_country_flag = TCH_karaulov_will_die
		kill_country_leader = yes
		every_unit_leader = { limit = { has_id = 13550 } remove_unit_leader = yes }
		add_ideas = TCH_dysfunctional_government
		country_event = { id = rcw_nc.8 days = 5 }
	}
	option = {
		trigger = {
			NOT = { has_country_flag = TCH_karaulov_will_die }
		}
		name = rcw_nc.7.b
		hidden_effect = {
			division_template = {
				name = "Kazachiy polk"
				regiments = {
					cavalry = { x = 0 y = 0 }
					cavalry = { x = 0 y = 1 }
					cavalry = { x = 0 y = 2 }
				}
			}
		}
		capital_scope = {
			create_unit = {
				division = "name = \"1-y Volgskiy polk Terskogo kazachyego voyska\" division_template = \"Kazachiy polk\" start_experience_factor = 0.1 start_equipment_factor = 1"
				owner = ROOT
			}
		}
		custom_effect_tooltip = rcw_nc_7_tt
	}
}
# Владикавказский погром
country_event = {
	id = rcw_nc.8
	title = rcw_nc.8.t
	desc = rcw_nc.8.desc
	picture = GFX_report_event_sov_redarmy
	
	is_triggered_only = yes
	
	option = {
		name = rcw_nc.8.a
		remove_ideas = TCH_vladikavkazian_soviet
	}
}
# 1-й Съезд трудовых народов Терека
country_event = {
	id = rcw_nc.9
	title = rcw_nc.9.t
	desc = rcw_nc.9.desc
	picture = GFX_report_event_sov_redarmy
	
	is_triggered_only = yes
	
	option = {
		name = rcw_nc.9.a
		add_popularity = {
			ideology = radical_socialism
			popularity = 0.12
		}
		add_popularity = {
			ideology = communism
			popularity = 0.12
		}
		hidden_effect = { country_event = { id = rcw_nc.10 days = 21 } }
	}
}
# 2-й Съезд трудовых народов Терека
country_event = {
	id = rcw_nc.10
	title = rcw_nc.10.t
	desc = {
		text = rcw_nc.10.desc
		trigger = {
			OR = {
				has_idea = TCH_dysfunctional_government
				has_idea = TCH_vladikavkazian_soviet
			}
		}
	}
	desc = {
		text = rcw_nc.10.desc_1
		trigger = {
			NOT = {
				has_idea = TCH_dysfunctional_government
				has_idea = TCH_vladikavkazian_soviet
			}
		}
	}
	picture = GFX_report_event_sov_redarmy
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						has_idea = TCH_dysfunctional_government
						has_idea = TCH_vladikavkazian_soviet
					}
				}
				create_dynamic_country = {
					original_tag = TCH
					set_temp_variable = { red_TCH = this }
					every_state = {
						limit = {
							OR = {
								is_core_of = TCH
								is_core_of = ISH
								is_core_of = CHC
								is_core_of = CBR
								is_core_of = BLK
								is_core_of = OSE
							}
							OWNER = {
								OR = {
									tag = RSR
									is_subject_of = RSR
								}
							}
						}
						var:red_TCH = {
							transfer_state = PREV
						}
					}
					hidden_effect = {
						division_template = {
							name = "Krasnaya Gvardiya"
							regiments = {
								militia = { x = 0 y = 0 }
								militia = { x = 0 y = 1 }
								militia = { x = 1 y = 0 }
							}
							priority = 0
							is_locked = yes
						}
					}
					hidden_effect = {
						set_politics = {
							ruling_party = communism
							elections_allowed = no
						}
						set_popularities = {
							radical_socialism = 35
							communism = 65
						}
						load_focus_tree = Terek_reds_focus
						add_random_ministers = yes
						add_random_ministers = yes
						add_ideas = neutral_foreign_policy_law
						if = {
							limit = { ROOT = { has_idea = TCH_soldiers_from_Caucasian_front } }
							add_ideas = TCH_soldiers_from_Caucasian_front
						}
						if = {
							limit = { ROOT = { has_idea = TCH_unpunished_bandit_raids } }
							add_ideas = TCH_unpunished_bandit_raids
						}
						if = {
							limit = { ROOT = { has_idea = TCH_bandit_raids } }
							add_ideas = TCH_bandit_raids
						}
						ROOT = { PREV = { transfer_foodstuffs_supply_crisis_idea_to_THIS_from_PREV = yes } }
						ROOT = { PREV = { transfer_hyper_inflation_idea_to_THIS_from_PREV = yes } }
						ROOT = { PREV = { transfer_collapse_of_railway_system_idea_to_THIS_from_PREV = yes } }
					}
					RSR = { var:red_TCH = { subjecting_script_with_transfer_parties_dominion = yes } }
					var:red_TCH = { save_global_event_target_as = red_TCH }
					every_country = {
						limit = {
							is_in_array = {
								array = unrecognized_states
								value = ROOT.id
							}
						}
						set_THIS_country_non_recognize_PREV = yes
					}
				}
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				has_idea = TCH_dysfunctional_government
				has_idea = TCH_vladikavkazian_soviet
			}
		}
		name = rcw_nc.10.a
		remove_ideas = TCH_dysfunctional_government
		remove_ideas = TCH_vladikavkazian_soviet
		remove_ideas = TCH_dvoevlastie
		set_politics = { ruling_party = communism }
		add_popularity = {
			ideology = communism
			popularity = 0.15
		}
		if = {
			limit = { RSR = { has_war_with = ROOT } }
			white_peace = RSR
		}
		hidden_effect = {
			division_template = {
				name = "Krasnaya Gvardiya"
				regiments = {
					militia = { x = 0 y = 0 }
					militia = { x = 0 y = 1 }
					militia = { x = 1 y = 0 }
				}
				priority = 0
				is_locked = yes
			}
		}
		every_state = {
			limit = {
				OR = {
					is_core_of = TCH
					is_core_of = ISH
					is_core_of = CHC
					is_core_of = CBR
					is_core_of = BLK
					is_core_of = OSE
				}
				OWNER = {
					OR = {
						tag = RSR
						is_subject_of = RSR
					}
				}
			}
			ROOT = { transfer_state = PREV }
			spawn_red_guard_in_state_CONTROLLER = yes
			spawn_red_guard_in_state_CONTROLLER = yes
		}
		if = {
			limit = { RSR = { NOT = { has_war_with = ROOT } } }
			RSR = { add_to_war = { targeted_alliance = PREV enemy = ROOT } }
		}
		RSR = { ROOT = { subjecting_script_with_transfer_parties_dominion = yes } }
		load_focus_tree = Terek_reds_focus
	}
	option = {
		trigger = {
			NOT = {
				has_idea = TCH_dysfunctional_government
				has_idea = TCH_vladikavkazian_soviet
			}
		}
		name = rcw_nc.10.b
		remove_ideas = TCH_dysfunctional_government
		remove_ideas = TCH_vladikavkazian_soviet
		remove_ideas = TCH_dvoevlastie
		event_target:red_TCH = {
			every_owned_state = {
				spawn_red_guard_in_state_CONTROLLER = yes
				spawn_red_guard_in_state_CONTROLLER = yes
			}
			declare_war_on = {
				target = ROOT
				type = annex_everything
			}
			add_civil_war_target = ROOT
			if = {
				limit = { RSR = { NOT = { has_war_with = ROOT } } }
				RSR = { add_to_war = { targeted_alliance = PREV enemy = ROOT } }
			}
		}
		clear_global_event_target = red_TCH
	}
	option = {
		trigger = {
			NOT = {
				has_idea = TCH_dysfunctional_government
				has_idea = TCH_vladikavkazian_soviet
			}
		}
		name = rcw_nc.10.c
		remove_ideas = TCH_dysfunctional_government
		remove_ideas = TCH_vladikavkazian_soviet
		remove_ideas = TCH_dvoevlastie
		event_target:red_TCH = {
			every_owned_state = {
				spawn_red_guard_in_state_CONTROLLER = yes
				spawn_red_guard_in_state_CONTROLLER = yes
			}
			declare_war_on = {
				target = ROOT
				type = annex_everything
			}
			add_civil_war_target = ROOT
			if = {
				limit = { RSR = { NOT = { has_war_with = ROOT } } }
				RSR = { add_to_war = { targeted_alliance = PREV enemy = ROOT } }
			}
		}
		event_target:red_TCH = { change_tag_from = ROOT }
		clear_global_event_target = red_TCH
	}
}
# Почётный караул
country_event = {
	id = rcw_nc.11
	title = rcw_nc.11.t
	desc = rcw_nc.11.desc
	picture = GFX_report_event_sov_redarmy
	
	is_triggered_only = yes
	
	option = {
		name = rcw_nc.11.a
		add_stability = 0.1
		add_political_power = 30
		add_popularity = {
			ideology = despotism
			popularity = 0.07
		}
	}
}
# Оборона нефтепромыслов
country_event = {
	id = rcw_nc.12
	title = rcw_nc.12.t
	desc = rcw_nc.12.desc
	picture = GFX_report_event_sov_redarmy
	
	is_triggered_only = yes
	
	option = {
		name = rcw_nc.12.a
		add_political_power = 20
		add_war_support = 0.05
	}
}
# Поиски покровителя
country_event = {
	id = rcw_nc.13
	title = rcw_nc.13.t
	desc = rcw_nc.13.desc
	picture = GFX_report_event_sov_redarmy
	
	trigger = {
		tag = TCH
		has_focus_tree = Terek_white_cossaks_focus
		has_war_with = RSR
		NOT = { has_idea = TCH_dvoevlastie }
		NOT = { has_idea = TCH_dysfunctional_government }
		any_other_country = {
			OR = {
				original_tag = CCA
				original_tag = RVA
			}
			NOT = { has_war_with = ROOT }
			has_war_with = RSR
		}
	}
	
	fire_only_once = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = rcw_nc.13.a
		random_other_country = {
			limit = {
				OR = {
					original_tag = CCA
					original_tag = RVA
				}
				NOT = { has_war_with = ROOT }
				has_war_with = RSR
			}
			annex_country = {
				target = ROOT
				transfer_troops = yes
			}
			if = {
				limit = { is_ai = yes ROOT = { is_ai = no } }
				change_tag_from = ROOT
			}
		}
	}
}